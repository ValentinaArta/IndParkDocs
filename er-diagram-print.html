<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<title>IndParkDocs ‚Äî ER –î–∏–∞–≥—Ä–∞–º–º–∞</title>
<style>
* { box-sizing: border-box; margin: 0; padding: 0; }
body { font-family: Arial, Helvetica, sans-serif; background: #ffffff; color: #111827; padding: 32px; }
h1 { font-size: 22px; font-weight: 800; color: #111827; margin-bottom: 4px; }
.subtitle { font-size: 13px; color: #6B7280; margin-bottom: 28px; }
.section-title { font-size: 11px; font-weight: 700; color: #6B7280; text-transform: uppercase; letter-spacing: 0.1em; margin-bottom: 14px; margin-top: 36px; border-bottom: 1px solid #E5E7EB; padding-bottom: 6px; }

.tables-row { display: flex; gap: 16px; flex-wrap: wrap; }
.db-table { background: #F9FAFB; border: 1.5px solid #D1D5DB; border-radius: 8px; min-width: 230px; overflow: hidden; }
.db-table-header { padding: 8px 12px; font-size: 12px; font-weight: 700; color: #111827; background: #F3F4F6; border-bottom: 1.5px solid #D1D5DB; display: flex; align-items: center; gap: 6px; }
.hbadge { font-size: 10px; font-weight: 800; padding: 1px 5px; border-radius: 3px; }
.db-table-row { padding: 4px 12px; font-size: 11px; display: flex; align-items: baseline; gap: 6px; border-bottom: 1px solid #F3F4F6; }
.db-table-row:last-child { border-bottom: none; }
.col-pk  { color: #B45309; font-size: 9px; font-weight: 800; background: #FEF3C7; border-radius: 2px; padding: 1px 4px; flex-shrink:0; }
.col-fk  { color: #4F46E5; font-size: 9px; font-weight: 800; background: #EEF2FF; border-radius: 2px; padding: 1px 4px; flex-shrink:0; }
.col-self{ color: #B45309; font-size: 9px; font-weight: 800; background: #FEF3C7; border-radius: 2px; padding: 1px 4px; flex-shrink:0; }
.col-name{ color: #111827; flex-shrink:0; }
.col-ru  { color: #6B7280; font-size: 10px; font-style: italic; flex:1; }
.col-type{ color: #9CA3AF; font-size: 10px; text-align:right; }
.col-jsonb{ color: #065F46; font-size: 9px; font-weight: 700; background: #D1FAE5; border-radius: 2px; padding: 1px 4px; }
.sp { display:inline-block; width:28px; flex-shrink:0; }

/* entity boxes */
.er-wrap { position:relative; width:100%; height:700px; }
.ebox { position:absolute; border-radius:8px; padding:9px 12px; min-width:145px; border:2px solid; }
.ebox .icon { font-size:15px; margin-bottom:2px; }
.ebox .title { font-size:12px; font-weight:700; }
.ebox .sub   { font-size:10px; color:#6B7280; margin-top:1px; }
.ebox .fields { font-size:10px; margin-top:5px; line-height:1.8; }
.ebox .fields span { display:block; }
.fn  { color:#374151; }
.fru { color:#6B7280; font-style:italic; }

.g-building { background:#F0FDF4; border-color:#16A34A; }
.g-company  { background:#EFF6FF; border-color:#2563EB; }
.g-contract { background:#EEF2FF; border-color:#4F46E5; }
.g-equip    { background:#FFFBEB; border-color:#D97706; }
.g-act      { background:#FFF7ED; border-color:#EA580C; }
.g-doc      { background:#F9FAFB; border-color:#9CA3AF; }

svg.arrows  { position:absolute; top:0; left:0; width:100%; height:100%; overflow:visible; pointer-events:none; }

.rel-table, .hier-table { border-collapse:collapse; font-size:12px; width:100%; max-width:720px; margin-top:4px; }
.rel-table th, .hier-table th { text-align:left; padding:7px 10px; background:#F3F4F6; color:#374151; font-weight:700; font-size:11px; border:1px solid #D1D5DB; }
.rel-table td, .hier-table td { padding:6px 10px; border:1px solid #E5E7EB; }
.rel-table tr:nth-child(even) td, .hier-table tr:nth-child(even) td { background:#F9FAFB; }
.rn { font-family:monospace; color:#4F46E5; background:#EEF2FF; padding:1px 5px; border-radius:3px; font-size:11px; }
.ra { color:#9CA3AF; }

.note { margin-top:28px; padding:14px 16px; background:#F9FAFB; border:1px solid #E5E7EB; border-radius:8px; font-size:12px; color:#374151; max-width:680px; line-height:1.7; }
code { font-family:monospace; background:#EEF2FF; color:#4F46E5; padding:1px 5px; border-radius:3px; font-size:11px; }
</style>
</head>
<body>

<h1>IndParkDocs ‚Äî ER –î–∏–∞–≥—Ä–∞–º–º–∞</h1>
<p class="subtitle">–§–∏–∑–∏—á–µ—Å–∫–∞—è —Å—Ö–µ–º–∞ –ë–î + –ª–æ–≥–∏—á–µ—Å–∫–∏–µ —Å–≤—è–∑–∏ —Å—É—â–Ω–æ—Å—Ç–µ–π. –ö—É—Ä—Å–∏–≤–æ–º ‚Äî –Ω–∞–∑–≤–∞–Ω–∏—è –Ω–∞ —Ä—É—Å—Å–∫–æ–º —è–∑—ã–∫–µ.</p>

<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê –§–ò–ó–ò–ß–ï–°–ö–ê–Ø –°–•–ï–ú–ê ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
<div class="section-title">üìê –§–∏–∑–∏—á–µ—Å–∫–∞—è —Å—Ö–µ–º–∞ (PostgreSQL)</div>
<div class="tables-row">

  <div class="db-table">
    <div class="db-table-header"><span class="hbadge" style="background:#EEF2FF;color:#4F46E5">ET</span> entity_types</div>
    <div class="db-table-row"><span class="col-pk">PK</span><span class="col-name">id</span><span class="col-ru">ID</span><span class="col-type">serial</span></div>
    <div class="db-table-row"><span class="sp"></span><span class="col-name">name</span><span class="col-ru">–°–∏—Å—Ç–µ–º–Ω–æ–µ –∏–º—è (UNIQUE)</span><span class="col-type">varchar</span></div>
    <div class="db-table-row"><span class="sp"></span><span class="col-name">name_ru</span><span class="col-ru">–ù–∞–∑–≤–∞–Ω–∏–µ (—Ä—É—Å.)</span><span class="col-type">varchar</span></div>
    <div class="db-table-row"><span class="sp"></span><span class="col-name">icon</span><span class="col-ru">–ò–∫–æ–Ω–∫–∞ (—ç–º–æ–¥–∑–∏)</span><span class="col-type">varchar</span></div>
    <div class="db-table-row"><span class="sp"></span><span class="col-name">color</span><span class="col-ru">–¶–≤–µ—Ç (hex)</span><span class="col-type">varchar</span></div>
    <div class="db-table-row"><span class="sp"></span><span class="col-name">sort_order</span><span class="col-ru">–ü–æ—Ä—è–¥–æ–∫ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏</span><span class="col-type">int</span></div>
  </div>

  <div class="db-table">
    <div class="db-table-header"><span class="hbadge" style="background:#D1FAE5;color:#065F46">FD</span> field_definitions</div>
    <div class="db-table-row"><span class="col-pk">PK</span><span class="col-name">id</span><span class="col-ru">ID</span><span class="col-type">serial</span></div>
    <div class="db-table-row"><span class="col-fk">FK</span><span class="col-name">entity_type_id</span><span class="col-ru">–¢–∏–ø —Å—É—â–Ω–æ—Å—Ç–∏</span></div>
    <div class="db-table-row"><span class="sp"></span><span class="col-name">name</span><span class="col-ru">–°–∏—Å—Ç–µ–º–Ω–æ–µ –∏–º—è –ø–æ–ª—è</span></div>
    <div class="db-table-row"><span class="sp"></span><span class="col-name">name_ru</span><span class="col-ru">–ù–∞–∑–≤–∞–Ω–∏–µ –ø–æ–ª—è (—Ä—É—Å.)</span></div>
    <div class="db-table-row"><span class="sp"></span><span class="col-name">field_type</span><span class="col-ru">–¢–∏–ø: text/number/date/select‚Ä¶</span></div>
    <div class="db-table-row"><span class="sp"></span><span class="col-name">options</span><span class="col-ru">–í–∞—Ä–∏–∞–Ω—Ç—ã (–¥–ª—è select)</span><span class="col-jsonb">JSONB</span></div>
    <div class="db-table-row"><span class="sp"></span><span class="col-name">sort_order</span><span class="col-ru">–ü–æ—Ä—è–¥–æ–∫ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è</span></div>
    <div class="db-table-row"><span class="sp"></span><span class="col-name">required</span><span class="col-ru">–û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–µ</span><span class="col-type">bool</span></div>
  </div>

  <div class="db-table" style="border-color:#4F46E5">
    <div class="db-table-header" style="background:#EEF2FF"><span class="hbadge" style="background:#4F46E5;color:#fff">E</span> entities ‚≠ê</div>
    <div class="db-table-row"><span class="col-pk">PK</span><span class="col-name">id</span><span class="col-ru">ID</span><span class="col-type">serial</span></div>
    <div class="db-table-row"><span class="col-fk">FK</span><span class="col-name">entity_type_id</span><span class="col-ru">–¢–∏–ø —Å—É—â–Ω–æ—Å—Ç–∏</span></div>
    <div class="db-table-row"><span class="sp"></span><span class="col-name">name</span><span class="col-ru">–ù–∞–∑–≤–∞–Ω–∏–µ</span><span class="col-type">varchar(255)</span></div>
    <div class="db-table-row"><span class="sp"></span><span class="col-name">properties</span><span class="col-ru">–°–≤–æ–π—Å—Ç–≤–∞ –æ–±—ä–µ–∫—Ç–∞</span><span class="col-jsonb">JSONB</span></div>
    <div class="db-table-row"><span class="col-self">SELF</span><span class="col-name">parent_id</span><span class="col-ru">–†–æ–¥–∏—Ç–µ–ª—å—Å–∫–∏–π –æ–±—ä–µ–∫—Ç</span></div>
    <div class="db-table-row"><span class="sp"></span><span class="col-name">created_at</span><span class="col-ru">–°–æ–∑–¥–∞–Ω</span><span class="col-type">timestamptz</span></div>
    <div class="db-table-row"><span class="sp"></span><span class="col-name">updated_at</span><span class="col-ru">–ò–∑–º–µ–Ω—ë–Ω</span><span class="col-type">timestamptz</span></div>
    <div class="db-table-row"><span class="sp"></span><span class="col-name">deleted_at</span><span class="col-ru">–£–¥–∞–ª—ë–Ω (–º—è–≥–∫–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ)</span></div>
  </div>

  <div class="db-table">
    <div class="db-table-header"><span class="hbadge" style="background:#FEF3C7;color:#B45309">R</span> relations</div>
    <div class="db-table-row"><span class="col-pk">PK</span><span class="col-name">id</span><span class="col-ru">ID</span><span class="col-type">serial</span></div>
    <div class="db-table-row"><span class="col-fk">FK</span><span class="col-name">from_entity_id</span><span class="col-ru">–û—Ç –∫–æ–≥–æ</span></div>
    <div class="db-table-row"><span class="col-fk">FK</span><span class="col-name">to_entity_id</span><span class="col-ru">–ö–æ–º—É</span></div>
    <div class="db-table-row"><span class="sp"></span><span class="col-name">relation_type</span><span class="col-ru">–¢–∏–ø —Å–≤—è–∑–∏</span><span class="col-type">varchar</span></div>
    <div class="db-table-row"><span class="sp"></span><span class="col-name">properties</span><span class="col-ru">–î–æ–ø. –¥–∞–Ω–Ω—ã–µ</span><span class="col-jsonb">JSONB</span></div>
    <div class="db-table-row"><span class="sp"></span><span class="col-name" style="color:#9CA3AF">UNIQUE(from, to, type)</span></div>
  </div>

  <div class="db-table">
    <div class="db-table-header"><span class="hbadge" style="background:#F3F4F6;color:#374151">RT</span> relation_types</div>
    <div class="db-table-row"><span class="col-pk">PK</span><span class="col-name">id</span><span class="col-ru">ID</span></div>
    <div class="db-table-row"><span class="sp"></span><span class="col-name">name</span><span class="col-ru">–°–∏—Å—Ç–µ–º–Ω–æ–µ –∏–º—è (UNIQUE)</span></div>
    <div class="db-table-row"><span class="sp"></span><span class="col-name">name_ru</span><span class="col-ru">–ù–∞–∑–≤–∞–Ω–∏–µ (—Ä—É—Å.)</span></div>
    <div class="db-table-row"><span class="col-fk">FK</span><span class="col-name">from_type_id</span><span class="col-ru">–¢–∏–ø –∏—Å—Ç–æ—á–Ω–∏–∫–∞</span></div>
    <div class="db-table-row"><span class="col-fk">FK</span><span class="col-name">to_type_id</span><span class="col-ru">–¢–∏–ø —Ü–µ–ª–∏</span></div>
    <div class="db-table-row"><span class="sp"></span><span class="col-name">color</span><span class="col-ru">–¶–≤–µ—Ç –ª–∏–Ω–∏–∏ (hex)</span></div>
  </div>

  <div class="db-table">
    <div class="db-table-header"><span class="hbadge" style="background:#FEE2E2;color:#B91C1C">AL</span> audit_log</div>
    <div class="db-table-row"><span class="col-pk">PK</span><span class="col-name">id</span><span class="col-ru">ID</span></div>
    <div class="db-table-row"><span class="sp"></span><span class="col-name">user_id</span><span class="col-ru">–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å</span></div>
    <div class="db-table-row"><span class="sp"></span><span class="col-name">action</span><span class="col-ru">–î–µ–π—Å—Ç–≤–∏–µ (create/update/delete)</span></div>
    <div class="db-table-row"><span class="sp"></span><span class="col-name">entity_type</span><span class="col-ru">–¢–∏–ø —Å—É—â–Ω–æ—Å—Ç–∏</span></div>
    <div class="db-table-row"><span class="sp"></span><span class="col-name">entity_id</span><span class="col-ru">ID –æ–±—ä–µ–∫—Ç–∞</span></div>
    <div class="db-table-row"><span class="sp"></span><span class="col-name">changes</span><span class="col-ru">–ß—Ç–æ –∏–∑–º–µ–Ω–∏–ª–æ—Å—å</span><span class="col-jsonb">JSONB</span></div>
    <div class="db-table-row"><span class="sp"></span><span class="col-name">ip</span><span class="col-ru">IP-–∞–¥—Ä–µ—Å</span></div>
    <div class="db-table-row"><span class="sp"></span><span class="col-name">created_at</span><span class="col-ru">–î–∞—Ç–∞ –∏ –≤—Ä–µ–º—è</span></div>
  </div>

</div>

<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê –õ–û–ì–ò–ß–ï–°–ö–ò–ï –°–í–Ø–ó–ò ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
<div class="section-title" style="margin-top:44px">üîó –õ–æ–≥–∏—á–µ—Å–∫–∏–µ —Å–≤—è–∑–∏ —Å—É—â–Ω–æ—Å—Ç–µ–π</div>

<div class="er-wrap">
<svg class="arrows" id="svg">
  <defs>
    <marker id="agr" markerWidth="7" markerHeight="7" refX="6" refY="3" orient="auto"><path d="M0,0 L0,6 L7,3 z" fill="#16A34A"/></marker>
    <marker id="ap"  markerWidth="7" markerHeight="7" refX="6" refY="3" orient="auto"><path d="M0,0 L0,6 L7,3 z" fill="#4F46E5"/></marker>
    <marker id="ab"  markerWidth="7" markerHeight="7" refX="6" refY="3" orient="auto"><path d="M0,0 L0,6 L7,3 z" fill="#2563EB"/></marker>
    <marker id="ay"  markerWidth="7" markerHeight="7" refX="6" refY="3" orient="auto"><path d="M0,0 L0,6 L7,3 z" fill="#D97706"/></marker>
    <marker id="ao"  markerWidth="7" markerHeight="7" refX="6" refY="3" orient="auto"><path d="M0,0 L0,6 L7,3 z" fill="#EA580C"/></marker>
  </defs>
</svg>

<div id="b_land" class="ebox g-building" style="left:12px;top:12px;min-width:152px">
  <div class="icon">üåç</div><div class="title">–ó–µ–º–µ–ª—å–Ω—ã–π —É—á–∞—Å—Ç–æ–∫</div>
  <div class="fields">
    <span><span class="fn">cadastral_number</span> <span class="fru">–ö–∞–¥–∞—Å—Ç—Ä–æ–≤—ã–π ‚Ññ</span></span>
    <span><span class="fn">area</span> <span class="fru">–ü–ª–æ—â–∞–¥—å (–≥–∞)</span></span>
    <span><span class="fn">owner</span> <span class="fru">–°–æ–±—Å—Ç–≤–µ–Ω–Ω–∏–∫</span></span>
    <span><span class="fn">address</span> <span class="fru">–ê–¥—Ä–µ—Å</span></span>
    <span><span class="fn">purpose</span> <span class="fru">–†–∞–∑—Ä–µ—à—ë–Ω–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ</span></span>
  </div>
</div>

<div id="b_building" class="ebox g-building" style="left:12px;top:188px;min-width:152px">
  <div class="icon">üè¢</div><div class="title">–ö–æ—Ä–ø—É—Å</div>
  <div class="fields">
    <span><span class="fn">cadastral_number</span> <span class="fru">–ö–∞–¥–∞—Å—Ç—Ä–æ–≤—ã–π ‚Ññ</span></span>
    <span><span class="fn">cadastral_value</span> <span class="fru">–ö–∞–¥–∞—Å—Ç—Ä–æ–≤–∞—è —Å—Ç–æ–∏–º–æ—Å—Ç—å</span></span>
    <span><span class="fn">owner</span> <span class="fru">–°–æ–±—Å—Ç–≤–µ–Ω–Ω–∏–∫</span></span>
  </div>
</div>

<div id="b_room" class="ebox g-building" style="left:12px;top:360px;min-width:152px">
  <div class="icon">üö™</div><div class="title">–ü–æ–º–µ—â–µ–Ω–∏–µ</div>
  <div class="fields">
    <span><span class="fn">object_type</span> <span class="fru">–¢–∏–ø –æ–±—ä–µ–∫—Ç–∞</span></span>
    <span><span class="fn">description</span> <span class="fru">–û–ø–∏—Å–∞–Ω–∏–µ</span></span>
    <span><span class="fn">area</span> <span class="fru">–ü–ª–æ—â–∞–¥—å, –º¬≤</span></span>
    <span><span class="fn">floor</span> <span class="fru">–≠—Ç–∞–∂</span></span>
    <span><span class="fn">room_number</span> <span class="fru">–ù–æ–º–µ—Ä –ø–æ–º–µ—â–µ–Ω–∏—è</span></span>
  </div>
</div>

<div id="b_company" class="ebox g-company" style="left:224px;top:12px;min-width:155px">
  <div class="icon">üèõ</div><div class="title">–ö–æ–º–ø–∞–Ω–∏—è</div>
  <div class="sub">is_own: –ù–∞—à–∞ / –ö–æ–Ω—Ç—Ä–∞–≥–µ–Ω—Ç</div>
  <div class="fields">
    <span><span class="fn">inn</span> <span class="fru">–ò–ù–ù</span></span>
    <span><span class="fn">kpp</span> <span class="fru">–ö–ü–ü</span></span>
    <span><span class="fn">ogrn</span> <span class="fru">–û–ì–†–ù</span></span>
    <span><span class="fn">address</span> <span class="fru">–ê–¥—Ä–µ—Å</span></span>
    <span><span class="fn">director</span> <span class="fru">–†—É–∫–æ–≤–æ–¥–∏—Ç–µ–ª—å</span></span>
  </div>
</div>

<div id="b_contract" class="ebox g-contract" style="left:224px;top:196px;min-width:162px">
  <div class="icon">üìÑ</div><div class="title">–î–æ–≥–æ–≤–æ—Ä</div>
  <div class="sub">–ê—Ä–µ–Ω–¥–∞ / –ü–æ–¥—Ä—è–¥ / –£—Å–ª—É–≥–∏‚Ä¶</div>
  <div class="fields">
    <span><span class="fn">number</span> <span class="fru">–ù–æ–º–µ—Ä –¥–æ–≥–æ–≤–æ—Ä–∞</span></span>
    <span><span class="fn">contract_date</span> <span class="fru">–î–∞—Ç–∞</span></span>
    <span><span class="fn">our_legal_entity</span> <span class="fru">–ù–∞—à–µ —é—Ä–ª–∏—Ü–æ</span></span>
    <span><span class="fn">contractor_name</span> <span class="fru">–ö–æ–Ω—Ç—Ä–∞–≥–µ–Ω—Ç</span></span>
    <span><span class="fn">rent_objects</span> <span class="fru">–û–±—ä–µ–∫—Ç—ã –∞—Ä–µ–Ω–¥—ã</span></span>
    <span><span class="fn">contract_end_date</span> <span class="fru">–°—Ä–æ–∫ –¥–µ–π—Å—Ç–≤–∏—è –¥–æ</span></span>
    <span><span class="fn">vat_rate</span> <span class="fru">–≤ —Ç.—á. –ù–î–°, %</span></span>
  </div>
</div>

<div id="b_supplement" class="ebox g-contract" style="left:224px;top:478px;min-width:162px">
  <div class="icon">üìé</div><div class="title">–î–æ–ø. —Å–æ–≥–ª–∞—à–µ–Ω–∏–µ</div>
  <div class="fields">
    <span><span class="fn">number</span> <span class="fru">–ù–æ–º–µ—Ä –î–°</span></span>
    <span><span class="fn">contract_date</span> <span class="fru">–î–∞—Ç–∞</span></span>
    <span><span class="fn">changes_description</span> <span class="fru">–ß—Ç–æ –ø–æ–º–µ–Ω—è–ª–æ—Å—å</span></span>
    <span><span class="fn">rent_objects</span> <span class="fru">–û–±—ä–µ–∫—Ç—ã –∞—Ä–µ–Ω–¥—ã</span></span>
    <span><span class="fn">equipment_list</span> <span class="fru">–°–ø–∏—Å–æ–∫ –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è</span></span>
    <span><span class="fn">transfer_equipment</span> <span class="fru">–ü–µ—Ä–µ–¥–∞—á–∞ –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è</span></span>
  </div>
</div>

<div id="b_act" class="ebox g-act" style="left:448px;top:478px;min-width:152px">
  <div class="icon">üìù</div><div class="title">–ê–∫—Ç</div>
  <div class="fields">
    <span><span class="fn">act_number</span> <span class="fru">–ù–æ–º–µ—Ä –∞–∫—Ç–∞</span></span>
    <span><span class="fn">act_date</span> <span class="fru">–î–∞—Ç–∞ –∞–∫—Ç–∞</span></span>
    <span><span class="fn">act_items</span> <span class="fru">–ü–æ–∑–∏—Ü–∏–∏ –∞–∫—Ç–∞</span></span>
    <span><span class="fn">total_amount</span> <span class="fru">–ò—Ç–æ–≥–æ –ø–æ –∞–∫—Ç—É</span></span>
    <span><span class="fn">parent_contract_name</span> <span class="fru">–î–æ–≥–æ–≤–æ—Ä-–æ—Å–Ω–æ–≤–∞–Ω–∏–µ</span></span>
  </div>
</div>

<div id="b_order" class="ebox g-doc" style="left:448px;top:208px;min-width:148px">
  <div class="icon">üìú</div><div class="title">–ü—Ä–∏–∫–∞–∑</div>
  <div class="fields">
    <span><span class="fn">order_number</span> <span class="fru">–ù–æ–º–µ—Ä –ø—Ä–∏–∫–∞–∑–∞</span></span>
    <span><span class="fn">order_date</span> <span class="fru">–î–∞—Ç–∞</span></span>
    <span><span class="fn">order_type</span> <span class="fru">–¢–∏–ø (–ö–æ–Ω—Å–µ—Ä–≤–∞—Ü–∏—è‚Ä¶)</span></span>
    <span><span class="fn">issued_by</span> <span class="fru">–ö–µ–º –≤—ã–¥–∞–Ω</span></span>
  </div>
</div>

<div id="b_equip" class="ebox g-equip" style="left:448px;top:12px;min-width:164px">
  <div class="icon">‚öôÔ∏è</div><div class="title">–û–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ</div>
  <div class="fields">
    <span><span class="fn">equipment_category</span> <span class="fru">–ö–∞—Ç–µ–≥–æ—Ä–∏—è</span></span>
    <span><span class="fn">equipment_kind</span> <span class="fru">–í–∏–¥</span></span>
    <span><span class="fn">inv_number</span> <span class="fru">–ò–Ω–≤. –Ω–æ–º–µ—Ä</span></span>
    <span><span class="fn">serial_number</span> <span class="fru">–°–µ—Ä–∏–π–Ω—ã–π –Ω–æ–º–µ—Ä</span></span>
    <span><span class="fn">year</span> <span class="fru">–ì–æ–¥ –≤—ã–ø—É—Å–∫–∞</span></span>
    <span><span class="fn">status</span> <span class="fru">–°—Ç–∞—Ç—É—Å</span></span>
    <span><span class="fn">balance_owner</span> <span class="fru">–°–æ–±—Å—Ç–≤–µ–Ω–Ω–∏–∫</span></span>
    <span><span class="fn">parent_id</span> <span class="fru">‚Üí —Å–µ–±–µ (–∏–µ—Ä–∞—Ä—Ö–∏—è)</span></span>
  </div>
</div>

<div id="b_crane" class="ebox g-equip" style="left:666px;top:12px;min-width:145px">
  <div class="icon">üõ§</div><div class="title">–ü–æ–¥–∫—Ä–∞–Ω–æ–≤—ã–π –ø—É—Ç—å</div>
  <div class="fields">
    <span><span class="fn">length</span> <span class="fru">–î–ª–∏–Ω–∞</span></span>
    <span><span class="fn">load_capacity</span> <span class="fru">–ì—Ä—É–∑–æ–ø–æ–¥—ä—ë–º–Ω–æ—Å—Ç—å</span></span>
    <span><span class="fn">rail_type</span> <span class="fru">–¢–∏–ø —Ä–µ–ª—å—Å–∞</span></span>
  </div>
</div>

</div>

<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê –¢–ê–ë–õ–ò–¶–´ –°–í–Ø–ó–ï–ô ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
<div class="section-title">üìã –¢–∏–ø—ã —Å–≤—è–∑–µ–π (—Ç–∞–±–ª–∏—Ü–∞ relations)</div>
<table class="rel-table">
  <thead>
    <tr><th>relation_type</th><th>–ù–∞–∑–≤–∞–Ω–∏–µ</th><th>–û—Ç (from)</th><th></th><th>–î–æ (to)</th><th>–°–æ–∑–¥–∞—ë—Ç—Å—è</th></tr>
  </thead>
  <tbody>
    <tr><td><span class="rn">party_to</span></td><td>—É—á–∞—Å—Ç–Ω–∏–∫ –¥–æ–≥–æ–≤–æ—Ä–∞</td><td>üèõ –ö–æ–º–ø–∞–Ω–∏—è</td><td class="ra">‚Üí</td><td>üìÑ –î–æ–≥–æ–≤–æ—Ä</td><td>–∞–≤—Ç–æ –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –¥–æ–≥–æ–≤–æ—Ä–∞</td></tr>
    <tr><td><span class="rn">located_in</span></td><td>—Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω–æ –≤</td><td>‚öôÔ∏è –û–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ</td><td class="ra">‚Üí</td><td>üö™ –ü–æ–º–µ—â–µ–Ω–∏–µ / üè¢ –ö–æ—Ä–ø—É—Å</td><td>–∞–≤—Ç–æ + –≤—Ä—É—á–Ω—É—é</td></tr>
    <tr><td><span class="rn">located_on</span></td><td>—Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω –Ω–∞</td><td>üè¢ –ö–æ—Ä–ø—É—Å</td><td class="ra">‚Üí</td><td>üåç –ó–µ–º–µ–ª—å–Ω—ã–π —É—á–∞—Å—Ç–æ–∫</td><td>–∏–∑ —Ñ–æ—Ä–º—ã –∫–æ—Ä–ø—É—Å–∞</td></tr>
    <tr><td><span class="rn">on_balance</span></td><td>–Ω–∞ –±–∞–ª–∞–Ω—Å–µ</td><td>‚öôÔ∏è –û–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ</td><td class="ra">‚Üí</td><td>üèõ –ö–æ–º–ø–∞–Ω–∏—è (—Å–≤–æ—è)</td><td>–∞–≤—Ç–æ –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è</td></tr>
    <tr><td><span class="rn">subject_of</span></td><td>–ø—Ä–µ–¥–º–µ—Ç –¥–æ–∫—É–º–µ–Ω—Ç–∞</td><td>‚öôÔ∏è –û–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ</td><td class="ra">‚Üí</td><td>üìù –ê–∫—Ç / üìÑ –î–æ–≥–æ–≤–æ—Ä</td><td>–∞–≤—Ç–æ –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –∞–∫—Ç–∞ / –î–°</td></tr>
    <tr><td><span class="rn">supplement_to</span></td><td>–∞–∫—Ç –∫ –¥–æ–≥–æ–≤–æ—Ä—É</td><td>üìù –ê–∫—Ç</td><td class="ra">‚Üí</td><td>üìÑ –î–æ–≥–æ–≤–æ—Ä</td><td>–∞–≤—Ç–æ –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –∞–∫—Ç–∞</td></tr>
  </tbody>
</table>

<div class="section-title" style="margin-top:28px">üì¶ –ò–µ—Ä–∞—Ä—Ö–∏—è —á–µ—Ä–µ–∑ parent_id (—Å–∞–º–æ—Å—Å—ã–ª–∫–∞ —Ç–∞–±–ª–∏—Ü—ã entities)</div>
<table class="hier-table">
  <thead>
    <tr><th>–î–æ—á–µ—Ä–Ω–∏–π –æ–±—ä–µ–∫—Ç</th><th></th><th>–†–æ–¥–∏—Ç–µ–ª—å</th><th>–ü—Ä–∏–º–µ—Ä</th></tr>
  </thead>
  <tbody>
    <tr><td>üö™ –ü–æ–º–µ—â–µ–Ω–∏–µ</td><td class="ra">‚Üí parent_id</td><td>üè¢ –ö–æ—Ä–ø—É—Å</td><td>–û—Ñ–∏—Å 201 ‚Üí –ö–æ—Ä–ø—É—Å –ê</td></tr>
    <tr><td>üó∫ –ß–∞—Å—Ç—å –ó–£</td><td class="ra">‚Üí parent_id</td><td>üåç –ó–µ–º–µ–ª—å–Ω—ã–π —É—á–∞—Å—Ç–æ–∫</td><td>–£—á–∞—Å—Ç–æ–∫ 1–ê ‚Üí –ó–£ ‚Ññ5</td></tr>
    <tr><td>‚öôÔ∏è –ö–æ–º–ø–æ–Ω–µ–Ω—Ç / –¥–µ—Ç–∞–ª—å</td><td class="ra">‚Üí parent_id</td><td>‚öôÔ∏è –û–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ</td><td>–ö–æ–ª—ë—Å–Ω–∞—è –ø–∞—Ä–∞ ‚Üí –ö—Ä–∞–Ω –º–æ—Å—Ç–æ–≤–æ–π</td></tr>
    <tr><td>üìé –î–æ–ø. —Å–æ–≥–ª–∞—à–µ–Ω–∏–µ</td><td class="ra">‚Üí parent_id</td><td>üìÑ –î–æ–≥–æ–≤–æ—Ä</td><td>–î–° ‚Ññ3 ‚Üí –î–æ–≥–æ–≤–æ—Ä ‚Ññ12-–ê</td></tr>
    <tr><td>üìù –ê–∫—Ç</td><td class="ra">‚Üí parent_id</td><td>üìÑ –î–æ–≥–æ–≤–æ—Ä</td><td>–ê–∫—Ç ‚Ññ7 ‚Üí –î–æ–≥–æ–≤–æ—Ä ‚Ññ12-–ê</td></tr>
  </tbody>
</table>

<div class="note">
  <strong>üí° –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–π –ø–∞—Ç—Ç–µ—Ä–Ω ‚Äî EAV (Entity‚ÄìAttribute‚ÄìValue):</strong><br>
  –í—Å–µ –æ–±—ä–µ–∫—Ç—ã —Å–∏—Å—Ç–µ–º—ã —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ <strong>–æ–¥–Ω–æ–π —Ç–∞–±–ª–∏—Ü–µ entities</strong>. –¢–∏–ø –æ–±—ä–µ–∫—Ç–∞ –∑–∞–¥–∞—ë—Ç—Å—è —á–µ—Ä–µ–∑ <code>entity_type_id</code>.
  –ê—Ç—Ä–∏–±—É—Ç—ã –∫–∞–∂–¥–æ–≥–æ —Ç–∏–ø–∞ –æ–ø–∏—Å–∞–Ω—ã –≤ <code>field_definitions</code> –∏ —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ <code>properties JSONB</code>.
  –°–≤—è–∑–∏ –º–µ–∂–¥—É –ª—é–±—ã–º–∏ –æ–±—ä–µ–∫—Ç–∞–º–∏ ‚Äî –≤ —Ç–∞–±–ª–∏—Ü–µ <code>relations</code>.
  –≠—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –¥–æ–±–∞–≤–ª—è—Ç—å –Ω–æ–≤—ã–µ —Ç–∏–ø—ã —Å—É—â–Ω–æ—Å—Ç–µ–π –∏ –ø–æ–ª—è <strong>–±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏—è —Å—Ö–µ–º—ã –ë–î</strong>.
</div>

<script>
window.addEventListener('load', function() {
  var svg = document.getElementById('svg');
  function m(id) {
    var el = document.getElementById(id);
    return { cx:el.offsetLeft+el.offsetWidth/2, cy:el.offsetTop+el.offsetHeight/2,
      l:el.offsetLeft, r:el.offsetLeft+el.offsetWidth, t:el.offsetTop, b:el.offsetTop+el.offsetHeight };
  }
  function arr(x1,y1,x2,y2,col,mk,lbl) {
    var ln=document.createElementNS('http://www.w3.org/2000/svg','line');
    ln.setAttribute('x1',x1);ln.setAttribute('y1',y1);ln.setAttribute('x2',x2);ln.setAttribute('y2',y2);
    ln.setAttribute('stroke',col);ln.setAttribute('stroke-width','1.5');
    ln.setAttribute('stroke-dasharray','5,3');ln.setAttribute('marker-end','url(#'+mk+')');
    svg.appendChild(ln);
    if(lbl){
      var t=document.createElementNS('http://www.w3.org/2000/svg','text');
      t.setAttribute('x',(x1+x2)/2+2);t.setAttribute('y',(y1+y2)/2-4);
      t.setAttribute('fill',col);t.setAttribute('font-size','9');
      t.setAttribute('text-anchor','middle');t.setAttribute('font-family','Arial');
      t.setAttribute('font-weight','700');t.textContent=lbl;svg.appendChild(t);
    }
  }
  function path(d,col,mk){
    var p=document.createElementNS('http://www.w3.org/2000/svg','path');
    p.setAttribute('d',d);p.setAttribute('stroke',col);p.setAttribute('stroke-width','1.5');
    p.setAttribute('fill','none');p.setAttribute('stroke-dasharray','5,3');
    p.setAttribute('marker-end','url(#'+mk+')');svg.appendChild(p);
  }
  var land=m('b_land'),bld=m('b_building'),room=m('b_room');
  var co=m('b_company'),ct=m('b_contract'),sp=m('b_supplement');
  var act=m('b_act'),eq=m('b_equip');

  arr(bld.cx,bld.t,land.cx,land.b,'#16A34A','agr','located_on');
  arr(room.cx,room.t,bld.cx,bld.b,'#16A34A','agr','parent_id');
  arr(co.cx,co.b,ct.cx,ct.t,'#2563EB','ab','party_to');
  arr(sp.cx,sp.t,ct.cx,ct.b,'#4F46E5','ap','parent_id');
  arr(act.l,act.cy,sp.r,sp.cy+12,'#EA580C','ao','supplement_to');
  arr(eq.cx,eq.b,ct.r+10,ct.cy-10,'#D97706','ay','subject_of');
  arr(eq.l,eq.b+16,room.r,room.t+10,'#D97706','ay','located_in');
  // self-ref
  path('M'+(eq.r)+','+(eq.t+24)+' L'+(eq.r+22)+','+(eq.t+24)+' L'+(eq.r+22)+','+(eq.t+58)+' L'+(eq.r)+','+(eq.t+58),'#D97706','ay');
  var st=document.createElementNS('http://www.w3.org/2000/svg','text');
  st.setAttribute('x',eq.r+25);st.setAttribute('y',eq.t+43);
  st.setAttribute('fill','#D97706');st.setAttribute('font-size','9');
  st.setAttribute('font-family','Arial');st.setAttribute('font-weight','700');
  st.textContent='parent_id';svg.appendChild(st);
});
</script>
</body>
</html>
