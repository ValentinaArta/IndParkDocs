# MEMORY.md ‚Äî –î–æ–ª–≥–æ—Å—Ä–æ—á–Ω–∞—è –ø–∞–º—è—Ç—å

## –ü—Ä–æ–µ–∫—Ç
- **IndParkDocs** ‚Äî —Å–∏—Å—Ç–µ–º–∞ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ –∏ —Å–≤—è–∑–µ–π –¥–ª—è –∏–Ω–¥—É—Å—Ç—Ä–∏–∞–ª—å–Ω–æ–≥–æ –ø–∞—Ä–∫–∞
- –†–µ–ø–æ: https://github.com/ValentinaArta/IndParkDocs.git (–≤–µ—Ç–∫–∏: main, dev)
- –ü—Ä–æ–¥–∞–∫—à–Ω: https://indparkdocs.onrender.com (Render free tier, —Å–ø–∏—Ç –±–µ–∑ –∑–∞–ø—Ä–æ—Å–æ–≤)
- –õ–æ–≥–∏–Ω: admin / 123456
- –°—Ç–µ–∫: Node.js + Express + PostgreSQL + inline SPA (–±–µ–∑ —Å–±–æ—Ä–∫–∏)
- –î–µ–ø–ª–æ–π: push –≤ main ‚Üí –∞–≤—Ç–æ–¥–µ–ø–ª–æ–π Render (~2 –º–∏–Ω)

## –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å
- –í–∞–ª–µ–Ω—Ç–∏–Ω–∞ (ValentinaArta –Ω–∞ GitHub)
- –û–±—â–µ–Ω–∏–µ –Ω–∞ —Ä—É—Å—Å–∫–æ–º
- –ù–µ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Å—Ç ‚Äî –æ–±—ä—è—Å–Ω—è—Ç—å –ø—Ä–æ—Å—Ç—ã–º —è–∑—ã–∫–æ–º
- –õ—é–±–∏—Ç –∫–æ–≥–¥–∞ —è —Å–∞–º —Å–ª–µ–∂—É –∑–∞ –¥–µ–ø–ª–æ–µ–º –∏ –ø–∏—à—É —Ç–æ–ª—å–∫–æ –∫–æ–≥–¥–∞ –≥–æ—Ç–æ–≤–æ

## –ö–ª—é—á–µ–≤—ã–µ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ —Ä–µ—à–µ–Ω–∏—è

### –ú–∏–≥—Ä–∞—Ü–∏–∏ –ë–î
- –ù–ï –∑–∞–ø—É—Å–∫–∞—Ç—å –∏–∑ Procfile (–Ω–µ—Ç DATABASE_URL –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ)
- –í—Å—Ç—Ä–∞–∏–≤–∞—Ç—å –≤ index.js –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ —Å–µ—Ä–≤–µ—Ä–∞ (runMigration003, runMigration004)
- –í—Å–µ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å ON CONFLICT DO NOTHING / DO UPDATE

### CI
- GitHub Actions: .github/workflows/ci.yml
- npm ci (–Ω–µ npm install) ‚Äî –Ω—É–∂–µ–Ω —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π package-lock.json
- –ü—Ä–æ–≤–µ—Ä—è–µ—Ç —Å–∏–Ω—Ç–∞–∫—Å–∏—Å + frontend JS —á–µ—Ä–µ–∑ new Function()

### Frontend JS
- –í—Å—è –ª–æ–≥–∏–∫–∞ –∏–Ω–ª–∞–π–Ω –≤ frontend.js, –æ—Ç–¥–∞—ë—Ç—Å—è –∫–∞–∫ HTML (–æ–¥–∏–Ω –±–æ–ª—å—à–æ–π template literal)
- –ü—Ä–æ–≤–µ—Ä—è—Ç—å —Å–∏–Ω—Ç–∞–∫—Å–∏—Å: node -e "new Function('async function __t(){' + m[1] + '}')"
- –û–ü–ê–°–ù–´–ï –∫–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏:
  - `\'string\'` –≤–Ω—É—Ç—Ä–∏ template literal ‚Üí —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è `'string'` –∏ –ª–æ–º–∞–µ—Ç —Å—Ç—Ä–æ–∫–∏ –≤ new Function
  - –†–µ—à–µ–Ω–∏–µ: –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å data-* –∞—Ç—Ä–∏–±—É—Ç—ã –≤–º–µ—Å—Ç–æ —Å—Ç—Ä–æ–∫ –≤ onclick, –∏–ª–∏ &apos;
  - catch {} –±–µ–∑ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞

### Git workflow
- feature/task ‚Üí dev ‚Üí (PR) ‚Üí main ‚Üí –∞–≤—Ç–æ–¥–µ–ø–ª–æ–π
- –ü–æ—Å–ª–µ –∫–∞–∂–¥–æ–≥–æ –ø—É—à–∞: –º–µ—Ä–∂–∏—Ç—å –æ–±–∞ –±—Ä–∞–Ω—á–∞, –∂–¥–∞—Ç—å –¥–µ–ø–ª–æ–π, –ø—Ä–æ–≤–µ—Ä—è—Ç—å

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö
- –í—Å–µ —Å—É—â–Ω–æ—Å—Ç–∏ –≤ —Ç–∞–±–ª–∏—Ü–µ entities (contracts, companies, buildings, rooms, equipment...)
- –°–≤—è–∑–∏ —á–µ—Ä–µ–∑ —Ç–∞–±–ª–∏—Ü—É relations (party_to, located_in, supplement_to, on_balance)
- –ö–æ–º–ø–∞–Ω–∏–∏: is_own=true ‚Üí –Ω–∞—à–∏ —é—Ä–ª–∏—Ü–∞, false ‚Üí –∫–æ–Ω—Ç—Ä–∞–≥–µ–Ω—Ç—ã (–æ–¥–Ω–∞ —Ç–∞–±–ª–∏—Ü–∞)
- –î–æ–≥–æ–≤–æ—Ä—ã —Ö—Ä–∞–Ω—è—Ç –∏ entity ID (contractor_id) –∏ –∏–º—è (contractor_name)
- –û–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ: parent_id = –∏–µ—Ä–∞—Ä—Ö–∏—è (–∑–∞–ø—á–∞—Å—Ç—å‚Üí–∫—Ä–∞–Ω‚Üí–ø—É—Ç—å), located_in relation = –º–µ—Å—Ç–æ —É—Å—Ç–∞–Ω–æ–≤–∫–∏

## –¢–∏–ø—ã —Å—É—â–Ω–æ—Å—Ç–µ–π (–∞–∫—Ç—É–∞–ª—å–Ω–æ)
| –¢–∏–ø | –ò–∫–æ–Ω–∫–∞ | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ |
|-----|--------|-----------|
| building | üè¢ | –ö–æ—Ä–ø—É—Å |
| workshop | üè≠ | –¶–µ—Ö |
| room | üö™ | –ü–æ–º–µ—â–µ–Ω–∏–µ |
| land_plot | üåç | –ó–µ–º–µ–ª—å–Ω—ã–π —É—á–∞—Å—Ç–æ–∫ (–Ω–æ–≤—ã–π) |
| company | üèõ | –ö–æ–º–ø–∞–Ω–∏—è (is_own=true/false) |
| contract | üìÑ | –î–æ–≥–æ–≤–æ—Ä |
| supplement | üìé | –î–æ–ø. —Å–æ–≥–ª–∞—à–µ–Ω–∏–µ |
| equipment | ‚öôÔ∏è | –û–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ |
| order | üìú | –ü—Ä–∏–∫–∞–∑ (–Ω–æ–≤—ã–π) |
| document | üìã | –î–æ–∫—É–º–µ–Ω—Ç |
| crane_track | üõ§ | –ü–æ–¥–∫—Ä–∞–Ω–æ–≤—ã–π –ø—É—Ç—å |

## –ü–æ–ª—è –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è (–ø–æ—Å–ª–µ migration 004)
- equipment_category: –≠–ª–µ–∫—Ç—Ä–æ–æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ / –ì–∞–∑–æ–≤–æ–µ / –¢–µ–ø–ª–æ–≤–æ–µ / –ö—Ä–∞–Ω–æ–≤–æ–µ —Ö–æ–∑—è–π—Å—Ç–≤–æ / –ú–∞—à–∏–Ω—ã –∏ –º–µ—Ö–∞–Ω–∏–∑–º—ã / –ò–ö –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ
- equipment_kind: —Å–≤–æ–±–æ–¥–Ω—ã–π —Ç–µ–∫—Å—Ç (–ø–æ–¥—Å—Ç–∞–Ω—Ü–∏—è, –∫–æ—Ç—ë–ª, –∫—Ä–∞–Ω...)
- inv_number, serial_number, year, manufacturer
- status: –í —Ä–∞–±–æ—Ç–µ / –ù–∞ —Ä–µ–º–æ–Ω—Ç–µ / –ó–∞–∫–æ–Ω—Å–µ—Ä–≤–∏—Ä–æ–≤–∞–Ω–æ / –°–ø–∏—Å–∞–Ω–æ
- balance_owner: entity selector (–Ω–∞—à–∏ –∫–æ–º–ø–∞–Ω–∏–∏, is_own=true) ‚Üí —Ö—Ä–∞–Ω–∏—Ç balance_owner_id + balance_owner_name
- note

## –ß—Ç–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ (–∞–∫—Ç—É–∞–ª—å–Ω–æ –Ω–∞ 2026-02-23)
- –î–æ–≥–æ–≤–æ—Ä—ã: —Å–æ–∑–¥–∞–Ω–∏–µ/—Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö —Ç–∏–ø–æ–≤ (–ü–æ–¥—Ä—è–¥, –ê—Ä–µ–Ω–¥–∞, –°—É–±–∞—Ä–µ–Ω–¥–∞, –£—Å–ª—É–≥–∏, –ö—É–ø–ª—è-–ø—Ä–æ–¥–∞–∂–∞...)
- –î–æ–ø. —Å–æ–≥–ª–∞—à–µ–Ω–∏—è —Å –ø–æ–ª–µ–º "—á—Ç–æ –ø–æ–º–µ–Ω—è–ª–æ—Å—å"
- –§–æ—Ä–º–∞ –∞—Ä–µ–Ω–¥—ã: –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –æ–±—ä–µ–∫—Ç—ã, –∞–≤—Ç–æ—Ä–∞—Å—á—ë—Ç –∞—Ä–µ–Ω–¥—ã, –ù–î–° 22%, –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏
- Entity selectors (–Ω–∞—à–µ —é—Ä–ª–∏—Ü–æ, –∫–æ–Ω—Ç—Ä–∞–≥–µ–Ω—Ç, –∫–æ—Ä–ø—É—Å, –ø–æ–º–µ—â–µ–Ω–∏–µ) ‚Äî styled –∫–∞–∫ select_or_custom
- –ê–≤—Ç–æ—Å–æ–∑–¥–∞–Ω–∏–µ relations –ø—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏ –¥–æ–≥–æ–≤–æ—Ä–∞ (party_to, located_in)
- –ò–µ—Ä–∞—Ä—Ö–∏—è —á–µ—Ä–µ–∑ parent_id, –ø–æ–ª–Ω—ã–π —Ö–ª–µ–±–Ω—ã–π –∫—Ä–æ—à–∫–∏ —Å —Ä–µ–∫—É—Ä—Å–∏–≤–Ω—ã–º CTE
- Inline —Ä–µ–¥–∞–∫—Ç–æ—Ä —Ä–æ–¥–∏—Ç–µ–ª—è –Ω–∞ –∫–∞—Ä—Ç–æ—á–∫–µ —Å—É—â–Ω–æ—Å—Ç–∏
- –ë–æ–∫–æ–≤–∞—è –Ω–∞–≤–∏–≥–∞—Ü–∏—è: –î–æ–∫—É–º–µ–Ω—Ç—ã + –†–µ–µ—Å—Ç—Ä—ã (–≤—Å–µ —Ç–∏–ø—ã —Å—É—â–Ω–æ—Å—Ç–µ–π)
- –°—Ç—Ä–∞–Ω–∏—Ü–∞ "–û—Ç—á—ë—Ç—ã":
  - –í–∫–ª–∞–¥–∫–∞ "–°–≤–æ–¥–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞" ‚Äî pivot –ø–æ –ª—é–±–æ–º—É –ø–æ–ª—é
  - –í–∫–ª–∞–¥–∫–∞ "–ü–æ —Å–≤—è–∑—è–º":
    - –û–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ –ø–æ –∫–æ—Ä–ø—É—Å–∞–º (via parent_id OR located_in relation)
    - –û–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ —É –∞—Ä–µ–Ω–¥–∞—Ç–æ—Ä–æ–≤ (via party_to ‚Üí contract ‚Üí located_in ‚Üí building ‚Üí equipment)
- –ö–æ–º–ø–∞–Ω–∏–∏ –≤ –ë–î: 6 –∑–∞–ø–∏—Å–µ–π (2 –Ω–∞—à–∏—Ö + 4 –∫–æ–Ω—Ç—Ä–∞–≥–µ–Ω—Ç–∞), –ø—Ä–∏–≤—è–∑–∞–Ω—ã –∫ –¥–æ–≥–æ–≤–æ—Ä–∞–º

## –ß—Ç–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ (–¥–æ–ø–æ–ª–Ω–µ–Ω–∏–µ, 2026-02-23)
- –ó–∞—â–∏—Ç–∞ –æ—Ç –¥—É–±–ª–∏–∫–∞—Ç–æ–≤: POST /entities –ø—Ä–æ–≤–µ—Ä—è–µ—Ç LOWER(name)+entity_type_id ‚Üí 409 —Å –¥–∞–Ω–Ω—ã–º–∏ —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–π
- frontend api(): err.status + err.data; 409 –±–µ–∑ auto-alert
- _doSubmitCreate(): confirm() –¥–∏–∞–ª–æ–≥ –ø—Ä–∏ 409, –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç —Å—É—â–µ—Å—Ç–≤—É—é—â—É—é —Å—É—â–Ω–æ—Å—Ç—å
- –ü–∏–≤–æ—Ç-—Ç–∞–±–ª–∏—Ü–∞: _pivotCellData (rows/cols/cells —Å –º–∞—Å—Å–∏–≤–∞–º–∏ —Å—É—â–Ω–æ—Å—Ç–µ–π), –∫–ª–∏–∫–∞–±–µ–ª—å–Ω—ã–µ —è—á–µ–π–∫–∏
- showPivotCellDetail(): drill-down –∫–∞—Ä—Ç–æ—á–∫–∏ –ø–æ–¥ —Ç–∞–±–ª–∏—Ü–µ–π
- "–ò—Ç–æ–≥–æ, –¥–æ–≥–æ–≤–æ—Ä—ã" ‚Äî –µ–¥–∏–Ω–∏—Ü—ã –≤ –∑–∞–≥–æ–ª–æ–≤–∫–µ –∏—Ç–æ–≥–æ–≤–æ–π –∫–æ–ª–æ–Ω–∫–∏
- –ò—Å–ø—Ä–∞–≤–ª–µ–Ω –∫–æ–Ω—Ç—Ä–∞–∫—Ç id=6: our_legal_entity ¬´–ó–≤–µ–∑–¥–∞¬ª —Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º–∏ –∫–∞–≤—ã—á–∫–∞–º–∏

## ‚ö†Ô∏è –ù–µ–∑–∞–¥–µ–ø–ª–æ–µ–Ω–æ (2026-02-23)
- frontend.js –∏–∑–º–µ–Ω—ë–Ω –Ω–æ –ù–ï –∑–∞–∫–æ–º–º–∏—á–µ–Ω/–∑–∞–¥–µ–ø–ª–æ–µ–Ω
- –ù—É–∂–Ω–æ: commit ‚Üí push dev ‚Üí merge main ‚Üí Render autodeploy (~2 –º–∏–Ω)

## –ü–ª–∞–Ω—ã / Next Steps
- **–°–ù–ê–ß–ê–õ–ê**: –∑–∞–¥–µ–ø–ª–æ–∏—Ç—å –Ω–µ–∑–∞–∫–æ–º–º–∏—á–µ–Ω–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è frontend.js
- –î–æ–±–∞–≤–∏—Ç—å –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ –≤ –±–∞–∑—É –∏ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –æ—Ç—á—ë—Ç—ã "–ü–æ —Å–≤—è–∑—è–º"
- Phase 2 –æ—Ç—á—ë—Ç–æ–≤: –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ —É –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã—Ö –∞—Ä–µ–Ω–¥–∞—Ç–æ—Ä–æ–≤ —á–µ—Ä–µ–∑ subject_of —Å–≤—è–∑—å
- –ö–æ–Ω—Å–µ—Ä–≤–∞—Ü–∏—è: –ª–∏–Ω–∫ –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è –Ω–∞ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π –ü—Ä–∏–∫–∞–∑
- –ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –ª–æ–∫–∞—Ü–∏–∏ –¥–ª—è –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è (–∫–∞–±–µ–ª—å–Ω—ã–µ –ª–∏–Ω–∏–∏ —á–µ—Ä–µ–∑ –Ω–µ—Å–∫–æ–ª—å–∫–æ –∫–æ—Ä–ø—É—Å–æ–≤)
