# MEMORY.md ‚Äî –î–æ–ª–≥–æ—Å—Ä–æ—á–Ω–∞—è –ø–∞–º—è—Ç—å

## –ü—Ä–æ–µ–∫—Ç
- **IndParkDocs** ‚Äî —Å–∏—Å—Ç–µ–º–∞ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ –∏ —Å–≤—è–∑–µ–π –¥–ª—è –∏–Ω–¥—É—Å—Ç—Ä–∏–∞–ª—å–Ω–æ–≥–æ –ø–∞—Ä–∫–∞
- –†–µ–ø–æ: https://github.com/ValentinaArta/IndParkDocs.git (–≤–µ—Ç–∫–∏: main, dev)
- –ü—Ä–æ–¥–∞–∫—à–Ω: https://indparkdocs.onrender.com (Render free tier, —Å–ø–∏—Ç –±–µ–∑ –∑–∞–ø—Ä–æ—Å–æ–≤)
- –õ–æ–≥–∏–Ω: admin / 123456
- –°—Ç–µ–∫: Node.js + Express + PostgreSQL + inline SPA (–±–µ–∑ —Å–±–æ—Ä–∫–∏)
- –î–µ–ø–ª–æ–π: push –≤ main ‚Üí –∞–≤—Ç–æ–¥–µ–ø–ª–æ–π Render (~2 –º–∏–Ω)

## –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å
- –í–∞–ª–µ–Ω—Ç–∏–Ω–∞ (ValentinaArta –Ω–∞ GitHub)
- –û–±—â–µ–Ω–∏–µ –Ω–∞ —Ä—É—Å—Å–∫–æ–º
- –ù–µ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Å—Ç ‚Äî –æ–±—ä—è—Å–Ω—è—Ç—å –ø—Ä–æ—Å—Ç—ã–º —è–∑—ã–∫–æ–º
- –õ—é–±–∏—Ç –∫–æ–≥–¥–∞ —è —Å–∞–º —Å–ª–µ–∂—É –∑–∞ –¥–µ–ø–ª–æ–µ–º –∏ –ø–∏—à—É —Ç–æ–ª—å–∫–æ –∫–æ–≥–¥–∞ –≥–æ—Ç–æ–≤–æ

## –ö–ª—é—á–µ–≤—ã–µ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ —Ä–µ—à–µ–Ω–∏—è

### –ú–∏–≥—Ä–∞—Ü–∏–∏ –ë–î
- –ù–ï –∑–∞–ø—É—Å–∫–∞—Ç—å –∏–∑ Procfile (–Ω–µ—Ç DATABASE_URL –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ)
- –í—Å—Ç—Ä–∞–∏–≤–∞—Ç—å –≤ index.js –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ —Å–µ—Ä–≤–µ—Ä–∞ (runMigration003, runMigration004)
- –í—Å–µ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å ON CONFLICT DO NOTHING / DO UPDATE

### CI
- GitHub Actions: .github/workflows/ci.yml
- npm ci (–Ω–µ npm install) ‚Äî –Ω—É–∂–µ–Ω —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π package-lock.json
- –ü—Ä–æ–≤–µ—Ä—è–µ—Ç —Å–∏–Ω—Ç–∞–∫—Å–∏—Å + frontend JS —á–µ—Ä–µ–∑ new Function()

### Frontend JS
- –í—Å—è –ª–æ–≥–∏–∫–∞ –∏–Ω–ª–∞–π–Ω –≤ frontend.js, –æ—Ç–¥–∞—ë—Ç—Å—è –∫–∞–∫ HTML (–æ–¥–∏–Ω –±–æ–ª—å—à–æ–π template literal)
- –ü—Ä–æ–≤–µ—Ä—è—Ç—å —Å–∏–Ω—Ç–∞–∫—Å–∏—Å: node -e "new Function('async function __t(){' + m[1] + '}')"
- –û–ü–ê–°–ù–´–ï –∫–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏:
  - `\'string\'` –≤–Ω—É—Ç—Ä–∏ template literal ‚Üí —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è `'string'` –∏ –ª–æ–º–∞–µ—Ç —Å—Ç—Ä–æ–∫–∏ –≤ new Function
  - –†–µ—à–µ–Ω–∏–µ: –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å data-* –∞—Ç—Ä–∏–±—É—Ç—ã –≤–º–µ—Å—Ç–æ —Å—Ç—Ä–æ–∫ –≤ onclick, –∏–ª–∏ &apos;
  - catch {} –±–µ–∑ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞

### Git workflow
- feature/task ‚Üí dev ‚Üí (PR) ‚Üí main ‚Üí –∞–≤—Ç–æ–¥–µ–ø–ª–æ–π
- –ü–æ—Å–ª–µ –∫–∞–∂–¥–æ–≥–æ –ø—É—à–∞: –º–µ—Ä–∂–∏—Ç—å –æ–±–∞ –±—Ä–∞–Ω—á–∞, –∂–¥–∞—Ç—å –¥–µ–ø–ª–æ–π, –ø—Ä–æ–≤–µ—Ä—è—Ç—å

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö
- –í—Å–µ —Å—É—â–Ω–æ—Å—Ç–∏ –≤ —Ç–∞–±–ª–∏—Ü–µ entities (contracts, companies, buildings, rooms, equipment...)
- –°–≤—è–∑–∏ —á–µ—Ä–µ–∑ —Ç–∞–±–ª–∏—Ü—É relations (party_to, located_in, supplement_to, on_balance)
- –ö–æ–º–ø–∞–Ω–∏–∏: is_own=true ‚Üí –Ω–∞—à–∏ —é—Ä–ª–∏—Ü–∞, false ‚Üí –∫–æ–Ω—Ç—Ä–∞–≥–µ–Ω—Ç—ã (–æ–¥–Ω–∞ —Ç–∞–±–ª–∏—Ü–∞)
- –î–æ–≥–æ–≤–æ—Ä—ã —Ö—Ä–∞–Ω—è—Ç –∏ entity ID (contractor_id) –∏ –∏–º—è (contractor_name)
- –û–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ: parent_id = –∏–µ—Ä–∞—Ä—Ö–∏—è (–∑–∞–ø—á–∞—Å—Ç—å‚Üí–∫—Ä–∞–Ω‚Üí–ø—É—Ç—å), located_in relation = –º–µ—Å—Ç–æ —É—Å—Ç–∞–Ω–æ–≤–∫–∏

## –¢–∏–ø—ã —Å—É—â–Ω–æ—Å—Ç–µ–π (–∞–∫—Ç—É–∞–ª—å–Ω–æ)
| –¢–∏–ø | –ò–∫–æ–Ω–∫–∞ | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ |
|-----|--------|-----------|
| building | üè¢ | –ö–æ—Ä–ø—É—Å |
| workshop | üè≠ | –¶–µ—Ö |
| room | üö™ | –ü–æ–º–µ—â–µ–Ω–∏–µ |
| land_plot | üåç | –ó–µ–º–µ–ª—å–Ω—ã–π —É—á–∞—Å—Ç–æ–∫ |
| company | üèõ | –ö–æ–º–ø–∞–Ω–∏—è (is_own=true/false) |
| contract | üìÑ | –î–æ–≥–æ–≤–æ—Ä |
| supplement | üìé | –î–æ–ø. —Å–æ–≥–ª–∞—à–µ–Ω–∏–µ |
| equipment | ‚öôÔ∏è | –û–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ |
| order | üìú | –ü—Ä–∏–∫–∞–∑ |
| document | üìã | –î–æ–∫—É–º–µ–Ω—Ç |
| crane_track | üõ§ | –ü–æ–¥–∫—Ä–∞–Ω–æ–≤—ã–π –ø—É—Ç—å |
| act | üìù | –ê–∫—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã—Ö —Ä–∞–±–æ—Ç (–¥–æ–±–∞–≤–ª–µ–Ω 2026-02-24) |

## –ü–æ–ª—è –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è (–ø–æ—Å–ª–µ migration 004)
- equipment_category: –≠–ª–µ–∫—Ç—Ä–æ–æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ / –ì–∞–∑–æ–≤–æ–µ / –¢–µ–ø–ª–æ–≤–æ–µ / –ö—Ä–∞–Ω–æ–≤–æ–µ —Ö–æ–∑—è–π—Å—Ç–≤–æ / –ú–∞—à–∏–Ω—ã –∏ –º–µ—Ö–∞–Ω–∏–∑–º—ã / –ò–ö –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ
- equipment_kind: —Å–≤–æ–±–æ–¥–Ω—ã–π —Ç–µ–∫—Å—Ç (–ø–æ–¥—Å—Ç–∞–Ω—Ü–∏—è, –∫–æ—Ç—ë–ª, –∫—Ä–∞–Ω...)
- inv_number, serial_number, year, manufacturer
- status: –í —Ä–∞–±–æ—Ç–µ / –ù–∞ —Ä–µ–º–æ–Ω—Ç–µ / –ó–∞–∫–æ–Ω—Å–µ—Ä–≤–∏—Ä–æ–≤–∞–Ω–æ / –°–ø–∏—Å–∞–Ω–æ
- balance_owner: entity selector (–Ω–∞—à–∏ –∫–æ–º–ø–∞–Ω–∏–∏, is_own=true) ‚Üí —Ö—Ä–∞–Ω–∏—Ç balance_owner_id + balance_owner_name
- note

## –ß—Ç–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ (–∞–∫—Ç—É–∞–ª—å–Ω–æ –Ω–∞ 2026-02-23)
- –î–æ–≥–æ–≤–æ—Ä—ã: —Å–æ–∑–¥–∞–Ω–∏–µ/—Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö —Ç–∏–ø–æ–≤ (–ü–æ–¥—Ä—è–¥, –ê—Ä–µ–Ω–¥–∞, –°—É–±–∞—Ä–µ–Ω–¥–∞, –£—Å–ª—É–≥–∏, –ö—É–ø–ª—è-–ø—Ä–æ–¥–∞–∂–∞...)
- –î–æ–ø. —Å–æ–≥–ª–∞—à–µ–Ω–∏—è —Å –ø–æ–ª–µ–º "—á—Ç–æ –ø–æ–º–µ–Ω—è–ª–æ—Å—å"
- –§–æ—Ä–º–∞ –∞—Ä–µ–Ω–¥—ã: –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –æ–±—ä–µ–∫—Ç—ã, –∞–≤—Ç–æ—Ä–∞—Å—á—ë—Ç –∞—Ä–µ–Ω–¥—ã, –ù–î–° 22%, –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏
- Entity selectors (–Ω–∞—à–µ —é—Ä–ª–∏—Ü–æ, –∫–æ–Ω—Ç—Ä–∞–≥–µ–Ω—Ç, –∫–æ—Ä–ø—É—Å, –ø–æ–º–µ—â–µ–Ω–∏–µ) ‚Äî styled –∫–∞–∫ select_or_custom
- –ê–≤—Ç–æ—Å–æ–∑–¥–∞–Ω–∏–µ relations –ø—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏ –¥–æ–≥–æ–≤–æ—Ä–∞ (party_to, located_in)
- –ò–µ—Ä–∞—Ä—Ö–∏—è —á–µ—Ä–µ–∑ parent_id, –ø–æ–ª–Ω—ã–π —Ö–ª–µ–±–Ω—ã–π –∫—Ä–æ—à–∫–∏ —Å —Ä–µ–∫—É—Ä—Å–∏–≤–Ω—ã–º CTE
- Inline —Ä–µ–¥–∞–∫—Ç–æ—Ä —Ä–æ–¥–∏—Ç–µ–ª—è –Ω–∞ –∫–∞—Ä—Ç–æ—á–∫–µ —Å—É—â–Ω–æ—Å—Ç–∏
- –ë–æ–∫–æ–≤–∞—è –Ω–∞–≤–∏–≥–∞—Ü–∏—è: –î–æ–∫—É–º–µ–Ω—Ç—ã + –†–µ–µ—Å—Ç—Ä—ã (–≤—Å–µ —Ç–∏–ø—ã —Å—É—â–Ω–æ—Å—Ç–µ–π)
- –°—Ç—Ä–∞–Ω–∏—Ü–∞ "–û—Ç—á—ë—Ç—ã":
  - –í–∫–ª–∞–¥–∫–∞ "–°–≤–æ–¥–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞" ‚Äî pivot –ø–æ –ª—é–±–æ–º—É –ø–æ–ª—é
  - –í–∫–ª–∞–¥–∫–∞ "–ü–æ —Å–≤—è–∑—è–º":
    - –û–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ –ø–æ –∫–æ—Ä–ø—É—Å–∞–º (via parent_id OR located_in relation)
    - –û–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ —É –∞—Ä–µ–Ω–¥–∞—Ç–æ—Ä–æ–≤ (via party_to ‚Üí contract ‚Üí located_in ‚Üí building ‚Üí equipment)
- –ö–æ–º–ø–∞–Ω–∏–∏ –≤ –ë–î: 6 –∑–∞–ø–∏—Å–µ–π (2 –Ω–∞—à–∏—Ö + 4 –∫–æ–Ω—Ç—Ä–∞–≥–µ–Ω—Ç–∞), –ø—Ä–∏–≤—è–∑–∞–Ω—ã –∫ –¥–æ–≥–æ–≤–æ—Ä–∞–º

## –ß—Ç–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ (2026-02-24) ‚Äî –ê–∫—Ç—ã + –¥–æ—Ä–∞–±–æ—Ç–∫–∏
- Migration 005: entity type `act`, field_definitions, relation type `supplement_to`
- `autoLinkEntities`: –≤–µ—Ç–∫–∞ –¥–ª—è act ‚Üí —Å–æ–∑–¥–∞—ë—Ç `supplement_to` –∫ –¥–æ–≥–æ–≤–æ—Ä—É + `subject_of` –æ—Ç –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è
- Aggregate report: Path 2 (equipment ‚Üí subject_of ‚Üí act ‚Üí supplement_to ‚Üí contract) —Å —Å—É–º–º–æ–π –∏–∑ act_items
- Frontend: —Ñ–æ—Ä–º–∞ —Å–æ–∑–¥–∞–Ω–∏—è –∞–∫—Ç–∞ —Å –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–º —Å–ø–∏—Å–∫–æ–º –ø–æ–∑–∏—Ü–∏–π (–æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ/—Å—É–º–º–∞/–æ–ø–∏—Å–∞–Ω–∏–µ)
- –ù–∞ –∫–∞—Ä—Ç–æ—á–∫–µ –¥–æ–≥–æ–≤–æ—Ä–∞: —Å–µ–∫—Ü–∏—è "–ê–∫—Ç—ã" + –∫–Ω–æ–ø–∫–∞ "+ –ê–∫—Ç"
- –ù–∞ –∫–∞—Ä—Ç–æ—á–∫–µ –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è: —Å–µ–∫—Ü–∏—è "–ò—Å—Ç–æ—Ä–∏—è —Ä–∞–±–æ—Ç" (–≤—Å–µ –∞–∫—Ç—ã –≥–¥–µ —É—á–∞—Å—Ç–≤—É–µ—Ç —ç—Ç–æ –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ)
- **–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –∞–∫—Ç–∞**: `parent_id = contract_id`, `act_items` = JSON-–º–∞—Å—Å–∏–≤ –ø–æ–∑–∏—Ü–∏–π, `supplement_to` relation + `subject_of` –¥–ª—è –∫–∞–∂–¥–æ–π –ø–æ–∑–∏—Ü–∏–∏
- –û–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ –≤ —Ñ–æ—Ä–º–µ –∞–∫—Ç–∞ —Ñ–∏–ª—å—Ç—Ä—É–µ—Ç—Å—è –ø–æ equipment_list –¥–æ–≥–æ–≤–æ—Ä–∞ (_actEquipmentList)
- –ü–æ–ª—è parent_contract_id/name ‚Äî readonly/hidden –≤ edit-—Ñ–æ—Ä–º–µ
- Migration 006: –≠–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏–∏ ‚Üí **–û–±—Å–ª—É–∂–∏–≤–∞–Ω–∏—è**, –ø–æ–ª—è service_subject / service_comment
- Migration 007: –ø–æ–ª–µ contract_end_date (–°—Ä–æ–∫ –¥–µ–π—Å—Ç–≤–∏—è –¥–æ) –¥–ª—è contract + supplement
- –ü–æ–ª–µ "–≤ —Ç.—á. –ù–î–°, %" –¥–æ–±–∞–≤–ª–µ–Ω–æ –≤ –æ–±—â–∏–µ –ø–æ–ª—è –≤—Å–µ—Ö –¥–æ–≥–æ–≤–æ—Ä–æ–≤
- **–ò–∑–º–µ–Ω—è–µ–º—ã–π —Ä–∞–∑–º–µ—Ä –º–æ–¥–∞–ª—å–Ω—ã—Ö –æ–∫–æ–Ω**: —Å—Ç–∞–Ω–¥–∞—Ä—Ç / —à–∏—Ä–æ–∫–∏–π (860px) / –≤–µ—Å—å —ç–∫—Ä–∞–Ω; setModalContent() / setModalSize() ‚Äî –ó–ê–ü–õ–ê–ù–ò–†–û–í–ê–ù–û, –ù–ï —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ
- Latest deployed commit: `4026fb5` (2026-02-24) ‚Äî debug alert –≤ openCreateActModal

## –ß—Ç–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ (–¥–æ–ø–æ–ª–Ω–µ–Ω–∏–µ, 2026-02-23)
- –ó–∞—â–∏—Ç–∞ –æ—Ç –¥—É–±–ª–∏–∫–∞—Ç–æ–≤: POST /entities –ø—Ä–æ–≤–µ—Ä—è–µ—Ç LOWER(name)+entity_type_id ‚Üí 409 —Å –¥–∞–Ω–Ω—ã–º–∏ —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–π
- frontend api(): err.status + err.data; 409 –±–µ–∑ auto-alert
- _doSubmitCreate(): confirm() –¥–∏–∞–ª–æ–≥ –ø—Ä–∏ 409, –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç —Å—É—â–µ—Å—Ç–≤—É—é—â—É—é —Å—É—â–Ω–æ—Å—Ç—å
- –ü–∏–≤–æ—Ç-—Ç–∞–±–ª–∏—Ü–∞: _pivotCellData (rows/cols/cells —Å –º–∞—Å—Å–∏–≤–∞–º–∏ —Å—É—â–Ω–æ—Å—Ç–µ–π), –∫–ª–∏–∫–∞–±–µ–ª—å–Ω—ã–µ —è—á–µ–π–∫–∏
- showPivotCellDetail(): drill-down –∫–∞—Ä—Ç–æ—á–∫–∏ –ø–æ–¥ —Ç–∞–±–ª–∏—Ü–µ–π
- "–ò—Ç–æ–≥–æ, –¥–æ–≥–æ–≤–æ—Ä—ã" ‚Äî –µ–¥–∏–Ω–∏—Ü—ã –≤ –∑–∞–≥–æ–ª–æ–≤–∫–µ –∏—Ç–æ–≥–æ–≤–æ–π –∫–æ–ª–æ–Ω–∫–∏
- –ò—Å–ø—Ä–∞–≤–ª–µ–Ω –∫–æ–Ω—Ç—Ä–∞–∫—Ç id=6: our_legal_entity ¬´–ó–≤–µ–∑–¥–∞¬ª —Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º–∏ –∫–∞–≤—ã—á–∫–∞–º–∏
- –ê—É–¥–∏—Ç –º–µ—Ç–æ–∫ –ø–æ–ª–µ–π –ø–∏–≤–æ—Ç–∞ ‚Äî –≤—Å–µ –ø–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω—ã, —É–±—Ä–∞–Ω—ã –¥—É–±–ª–∏—Ä—É—é—â–∏–µ
- Equipment inline-create –≤ —Ñ–æ—Ä–º–µ –¥–æ–≥–æ–≤–æ—Ä–∞ –∞—Ä–µ–Ω–¥—ã
- autoLinkEntities() —Å–æ–∑–¥–∞—ë—Ç subject_of relation (equipment ‚Üí contract)
- **Pivot equipment mode** (commit 8a010c9, –ó–ê–î–ï–ü–õ–û–ï–ù):
  - –ê–≤—Ç–æ-–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ: –µ—Å–ª–∏ –≤ –∑–æ–Ω–∞—Ö —Å—Ç—Ä–æ–∫/–∫–æ–ª–æ–Ω–æ–∫ –µ—Å—Ç—å eq_* –ø–æ–ª—è ‚Üí equipment mode
  - –°—á–∏—Ç–∞–µ—Ç –µ–¥–∏–Ω–∏—Ü—ã –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è, –¥–µ–¥—É–ø–ª–∏–∫–∞—Ü–∏—è –ø–æ equipment_id
  - eq_* virtual fields: eq_name, eq_category, eq_kind, eq_status, eq_inv_number, eq_manufacturer

## –ß—Ç–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ (2026-02-25) ‚Äî –ê–Ω–∞–ª–∏–∑ –∞—Ä–µ–Ω–¥—ã (—á–∞—Å—Ç–∏—á–Ω–æ)
- Migration 009: –ø–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ balance_owner ‚Üí –°–æ–±—Å—Ç–≤–µ–Ω–Ω–∏–∫; land_plot/building fields; `located_on` relation
- Building form: –°–æ–±—Å—Ç–≤–µ–Ω–Ω–∏–∫ (company selector), land_plot selector, quickCreateLandPlot(), `located_on` relation
- "–ò—Å—Ç–æ—Ä–∏—è —Ä–∞–±–æ—Ç" report tab: backend `GET /reports/work-history`, —Ç–∞–±–ª–∏—Ü–∞: —Å—Ç—Ä–æ–∫–∏=–æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ, –∫–æ–ª–æ–Ω–∫–∏=–¥–∞—Ç—ã –∞–∫—Ç–æ–≤, —è—á–µ–π–∫–∏=–æ–ø–∏—Å–∞–Ω–∏—è+—Å—É–º–º—ã+—Å—Å—ã–ª–∫–∏, –ò—Ç–æ–≥–æ ‚ÇΩ
- AGG_CONTRACT_TYPES: –∏—Å–∫–ª—é—á–µ–Ω—ã –ê—Ä–µ–Ω–¥—ã/–°—É–±–∞—Ä–µ–Ω–¥—ã (–≤—ã–Ω–µ—Å–µ–Ω—ã –≤ –æ—Ç–¥–µ–ª—å–Ω—É—é –≤–∫–ª–∞–¥–∫—É)
- "+ –ê–∫—Ç" 409 –¥—É–±–ª–∏—Ä—É–µ—Ç ‚Üí confirm –¥–∏–∞–ª–æ–≥ (commit `16f7bcc`)
- "–ê–Ω–∞–ª–∏–∑ –∞—Ä–µ–Ω–¥—ã" tab: **–±—ç–∫–µ–Ω–¥ + HTML/CSS –∑–∞–¥–µ–ø–ª–æ–µ–Ω—ã, JS —Ñ—É–Ω–∫—Ü–∏–∏ –ù–ï –∑–∞–≤–µ—Ä—à–µ–Ω—ã**
  - Backend: `GET /api/reports/rent-analysis` —Ñ–ª–∞—Ç—Ç–µ–Ω–∏—Ç rent_objects –∏–∑ –ê—Ä–µ–Ω–¥–∞/–°—É–±–∞—Ä–µ–Ω–¥–∞
  - Frontend: –≤–∫–ª–∞–¥–∫–∞ + —Å–µ–∫—Ü–∏—è + CSS –µ—Å—Ç—å, JS —Ñ—É–Ω–∫—Ü–∏–∏ (buildRentAnalysis, renderRentTable, —Ñ–∏–ª—å—Ç—Ä—ã, –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞) –Ω–µ –¥–æ–ø–∏—Å–∞–Ω—ã
  - –ù—É–∂–Ω–æ: `_rentAllRows`, `_rentFilters`, `_rentGroupBy` + 7 —Ñ—É–Ω–∫—Ü–∏–π (—Å–º. memory/2026-02-25.md)

## –ß—Ç–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ (2026-02-25 –ø–æ–∑–¥–Ω–∏–π –≤–µ—á–µ—Ä)
- **–¢–∏–ø –ø–æ–º–µ—â–µ–Ω–∏—è (object_type)** ‚Äî –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω–∞—è —Å—Ç—Ä–æ–∫–∞ –Ω–∞ —Å—É—â–Ω–æ—Å—Ç–∏ room; –∞–≤—Ç–æ–ø–æ–¥—Å—Ç–∞–≤–ª—è–µ—Ç—Å—è –≤ —Ñ–æ—Ä–º—É –∞—Ä–µ–Ω–¥—ã
- **–ö–∞—Ä—Ç–æ—á–∫–∞ –¥–æ–≥–æ–≤–æ—Ä–∞ –∞—Ä–µ–Ω–¥—ã** ‚Äî endpoint `GET /api/reports/contract-card/:id`; –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –≤ frontend
  - –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç: –∞—Ä–µ–Ω–¥–∞—Ç–æ—Ä, –Ω–∞—à —é—Ä–ª–∏—Ü–æ, –ø–æ–º–µ—â–µ–Ω–∏—è+–ø–ª–æ—â–∞–¥–∏+—Å—Ç–∞–≤–∫–∏, –µ–∂–µ–º–µ—Å—è—á–Ω—ã–π –ø–ª–∞—Ç—ë–∂, –ø–µ—Ä–µ–¥–∞–Ω–Ω–æ–µ –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ, –∏—Å—Ç–æ—Ä–∏—è –î–°
  - –ê–≤–∞—Ä–∏–π–Ω–æ–µ –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ –≤ –∫–∞—Ä—Ç–æ—á–∫–µ –ø–æ–¥—Å–≤–µ—á–∏–≤–∞–µ—Ç—Å—è –∫—Ä–∞—Å–Ω—ã–º
  - –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é –¥–ª—è –∞—Ä–µ–Ω–¥—ã –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è –∫–∞—Ä—Ç–æ—á–∫–∞; –∫–Ω–æ–ø–∫–∞ "üìã –î–µ—Ç–∞–ª–∏" ‚Äî raw view
- **–ö—Ä–∞—Å–Ω–∞—è –ø–æ–¥—Å–≤–µ—Ç–∫–∞ –∞–≤–∞—Ä–∏–π–Ω–æ–≥–æ –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è** ‚Äî —Ç–µ–ø–µ—Ä—å —Ä–∞–±–æ—Ç–∞–µ—Ç –≤–µ–∑–¥–µ: –∫–∞—Ä—Ç–æ—á–∫–∞ —Å—É—â–Ω–æ—Å—Ç–∏ + —Ä–µ–µ—Å—Ç—Ä (—Ä–∞–Ω–µ–µ —Ç–æ–ª—å–∫–æ –æ—Ç—á—ë—Ç—ã)

## –ó–∞–¥–µ–ø–ª–æ–µ–Ω–Ω—ã–π –∫–æ–º–º–∏—Ç
`db09f74` (main) ‚Äî fix: red highlighting for emergency/broken equipment everywhere (2026-02-26 –ø–æ–∑–¥–Ω–æ)

**–ü—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω—ã–µ –∫–æ–º–º–∏—Ç—ã (dev‚Üímain —Å–µ–≥–æ–¥–Ω—è):**
- `e7b105d`, `438b7d7` ‚Äî emergency/broken badges –≤ agg report + entity registry
- `980c31b` / `719e7ae` ‚Äî duplicate equipment level fix (eqAlreadyGrouped)
- `6ec6438` / `cb07486` ‚Äî contract card view endpoint + frontend
- `124b130` / `2502808` ‚Äî contract card –∫–∞–∫ default view –¥–ª—è –∞—Ä–µ–Ω–¥—ã
- `8c9e3e3` / `db09f74` ‚Äî emergency/broken –≤–µ–∑–¥–µ –≤–∫–ª—é—á–∞—è –±–µ–∫–µ–Ω–¥

## ‚ö†Ô∏è –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ô –£–†–û–ö: `\'` –≤–Ω—É—Ç—Ä–∏ JS template literal
- `\'` –≤–Ω—É—Ç—Ä–∏ template literal ‚Üí –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç `'` (—Å–ª–µ—à –°–™–ï–î–ê–ï–¢–°–Ø!) –≤ HTML output
- –≠—Ç–æ –ª–æ–º–∞–µ—Ç inline onclick —Å—Ç—Ä–æ–∫–∏ –∏ –∫—Ä–∞—à–∏—Ç –≤–µ—Å—å `<script>` –±–ª–æ–∫
- **–ü—Ä–∞–≤–∏–ª—å–Ω–æ**: `\\'` (–¥–≤–æ–π–Ω–æ–π —Å–ª–µ—à) ‚Üí –≤ HTML `\'` ‚Üí –≤ –±—Ä–∞—É–∑–µ—Ä–µ —Ä–∞–±–æ—Ç–∞–µ—Ç
- **–õ—É—á—à–µ**: data-–∞—Ç—Ä–∏–±—É—Ç—ã –≤–º–µ—Å—Ç–æ escaped –∫–∞–≤—ã—á–µ–∫ –≤ onclick

## –ß—Ç–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ (2026-02-26) ‚Äî 9 –∑–∞–¥–∞—á + —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–∏

### 9 –∑–∞–¥–∞—á (–∫–æ–º–º–∏—Ç d77c5ad):
- –§–æ—Ä–º–∞ –∞–∫—Ç–∞: –∫–∞–∂–¥—ã–π –±–ª–æ–∫ –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è –≤–∏–∑—É–∞–ª—å–Ω–æ –æ—Ç–¥–µ–ª—å–Ω—ã–π. –ò—Å–ø—Ä–∞–≤–ª–µ–Ω –±–∞–≥: –Ω–µ–∑–∞–∫—Ä—ã—Ç—ã–π `</div>` –≤ `_renderActItem` ‚Äî –∫–Ω–æ–ø–∫–∞ "+ –î–æ–±–∞–≤–∏—Ç—å –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ" —Ç–µ–ø–µ—Ä—å —Ä–∞–±–æ—Ç–∞–µ—Ç
- `openSupplementCard(id)` ‚Äî –∫–∞—Ä—Ç–æ—á–∫–∞ –î–° –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Ç–æ–ª—å–∫–æ –∏–∑–º–µ–Ω–µ–Ω–∏—è
- –í –∏—Å—Ç–æ—Ä–∏–∏ –î–° –¥–æ–≥–æ–≤–æ—Ä –∫–ª–∏–∫–∞–±–µ–ª—å–Ω—ã–π (–æ—Ç–∫—Ä—ã–≤–∞–µ—Ç contractCard)
- –ê–Ω–∞–ª–∏–∑ –∞—Ä–µ–Ω–¥—ã: –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ ‚Üí —Ñ–∏–ª—å—Ç—Ä-–∑–∞–≥–æ–ª–æ–≤–∫–∏ (—Ç–∞–±–ª–∏—Ü–∞ –≤—Å–µ–≥–¥–∞ –ø–ª–æ—Å–∫–∞—è)
- –£–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–æ "–¢–∏–ø –ø–æ–º–µ—â–µ–Ω–∏—è" –≤–µ–∑–¥–µ (–±—ã–ª–æ "–¢–∏–ø –æ–±—ä–µ–∫—Ç–∞" –≤ —á–∞—Å—Ç–∏ –º–µ—Å—Ç)
- –ü–æ–ª–Ω—ã–µ inline-—Ñ–æ—Ä–º—ã –¥–ª—è –ø–æ–º–µ—â–µ–Ω–∏—è –∏ –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è (–≤—Å–µ –ø–æ–ª—è)
- –ö–Ω–æ–ø–∫–∞ "+ –î–°" –≤ –∫–∞—Ä—Ç–æ—á–∫–µ –¥–æ–≥–æ–≤–æ—Ä–∞
- –°–æ–∑–¥–∞–Ω–∏–µ –î–° –∏–∑ —Ä–µ–µ—Å—Ç—Ä–∞ ‚Üí —Å–Ω–∞—á–∞–ª–∞ –≤—ã–±–æ—Ä –¥–æ–≥–æ–≤–æ—Ä–∞

### –°–ø—Ä–∞–≤–æ—á–Ω–∏–∫–∏ (–∫–æ–º–º–∏—Ç af589f8):
- –í–∫–ª–∞–¥–∫–∞ "üìã –°–ø—Ä–∞–≤–æ—á–Ω–∏–∫–∏" –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö
- –ë—ç–∫–µ–Ω–¥: `GET/PATCH /api/entity-types/settings/lists`
- –†–µ–¥–∞–∫—Ç–æ—Ä —Å–ø–∏—Å–∫–æ–≤: add/rename/delete –ø—É–Ω–∫—Ç–æ–≤, —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è OBJECT_TYPES/EQUIPMENT_CATEGORIES

## –ß—Ç–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ (2026-02-26) ‚Äî Sidebar + Room form

- **Sidebar redesign** (42d9306): –î–æ–∫—É–º–µ–Ω—Ç—ã + –†–µ–µ—Å—Ç—Ä—ã —Å –∞–∫–∫–æ—Ä–¥–µ–æ–Ω-–≥—Ä—É–ø–ø–∞–º–∏; –ö–æ—Ä–ø—É—Å–∞ ‚Üí –ü–æ–º–µ—â–µ–Ω–∏—è; –ö–æ–º–ø–∞–Ω–∏–∏ ‚Üí –ù–∞—à–∏/–°—Ç–æ—Ä–æ–Ω–Ω–∏–µ; lazy-loading; —É–±—Ä–∞–Ω—ã workshop/crane_track/document –∏–∑ –º–µ–Ω—é
- **"–≤—Å–µ –ø–æ–º–µ—â–µ–Ω–∏—è"** (4845a55): –ø–µ—Ä–≤—ã–π sub-item –≤ –ö–æ—Ä–ø—É—Å–∞ (italic, –±–µ–∑ —Ñ–∏–ª—å—Ç—Ä–∞) ‚Äî orphan rooms (parent_id=null) –≤—Å–µ–≥–¥–∞ –≤–∏–¥–Ω—ã
- **Room form** (64fc7d5): Migration 016 —Å–∫—Ä—ã–≤–∞–µ—Ç room_number+room_type (sort_order=999); `renderRoomBuildingParent()` ‚Äî dropdown —Ç–æ–ª—å–∫–æ –∑–¥–∞–Ω–∏–π; inline quick-create –∑–¥–∞–Ω–∏—è; `openCreateModal(type, preParentId)` ‚Äî –ø—Ä–µ–¥–≤—ã–±–æ—Ä –∑–¥–∞–Ω–∏—è
- **–°–ø—Ä–∞–≤–æ—á–Ω–∏–∫ –∫–∞–∫ –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã–π –∏—Å—Ç–æ—á–Ω–∏–∫** (5833659): OBJECT_TYPES/EQUIPMENT_CATEGORIES/EQUIPMENT_STATUSES –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –∏–∑ –ë–î –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ –≤ startApp()
- **–î–° –Ω–∞—Å–ª–µ–¥—É–µ—Ç contract_type** (5833659): readonly badge + hidden input, —Ç–∏–ø –¥–æ–≥–æ–≤–æ—Ä–∞ –Ω–µ–ª—å–∑—è –º–µ–Ω—è—Ç—å –≤ –î–°
- **is_own=false —Ñ–∏–ª—å—Ç—Ä**: IS DISTINCT FROM 'true' (–ª–æ–≤–∏—Ç null/false/missing)
- **Orphan rooms**: [44] –¶–µ—Ö –§–æ—Ä–º–∞–Ω, [45] –ê–ë–ö –§–æ—Ä–º–∞–Ω 3 —ç—Ç–∞–∂, [58] –°–∫–ª–∞–¥ –í–µ–Ω–≥–µ—Ä—Å–∫–æ–≥–æ —Ü–µ—Ö–∞ ‚Äî parent_id=null, –≤–∏–¥–Ω—ã —á–µ—Ä–µ–∑ "–≤—Å–µ –ø–æ–º–µ—â–µ–Ω–∏—è", –í–∞–ª–µ–Ω—Ç–∏–Ω–∞ –¥–æ–ª–∂–Ω–∞ –Ω–∞–∑–Ω–∞—á–∏—Ç—å –∫–æ—Ä–ø—É—Å–∞

## –ß—Ç–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ (2026-02-26 –≤–µ—á–µ—Ä) ‚Äî Dropdowns + inline editor

- **–£–±—Ä–∞–Ω—ã –≤—ã–∑–æ–≤—ã enrichFieldOptions** (14c44a3): –≤—Å–µ select/select_or_custom –ø–æ–ª—è –∏—Å–ø–æ–ª—å–∑—É—é—Ç —á–∏—Å—Ç—ã–µ `f.options` –∏–∑ —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–∞ ‚Äî –Ω–∏–∫–∞–∫–æ–≥–æ –ø–æ–¥–º–µ—à–∏–≤–∞–Ω–∏—è –∑–Ω–∞—á–µ–Ω–∏–π –∏–∑ —Å—Ç–∞—Ä—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- **–ö–æ—Ä–ø—É—Å –∏ –ê—Ä–µ–Ω–¥–∞—Ç–æ—Ä –≤ –ü–æ–¥—Ä—è–¥–∞/–û–±—Å–ª—É–∂–∏–≤–∞–Ω–∏—è** (14c44a3): –¥–æ–±–∞–≤–ª–µ–Ω `renderRegistrySelectField()` ‚Äî dropdown –∏–∑ —Ä–µ–µ—Å—Ç—Ä–∞ (`_buildings` / `_allCompanies`) + "–î—Ä—É–≥–æ–µ..." –¥–ª—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏; —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç —Å—Ç—Ä–æ–∫—É NAME
- **–£–±—Ä–∞–Ω inline-—Ä–µ–¥–∞–∫—Ç–æ—Ä —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏—è** (14c44a3): —É–¥–∞–ª–µ–Ω—ã `toggleParentEdit`, `saveParent`, –∫–Ω–æ–ø–∫–∞ "–ò–∑–º–µ–Ω–∏—Ç—å" –∏ `parentEditBlock` —Å –∫–∞—Ä—Ç–æ—á–µ–∫ —Å—É—â–Ω–æ—Å—Ç–µ–π

## ‚ö†Ô∏è –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ô –£–†–û–ö: `enrichFieldOptions` = –∑–ª–æ
- `getUsedValues(fieldName)` —Å–∫–∞–Ω `_allContractEntities` ‚Üí –ø–æ–¥–º–µ—à–∏–≤–∞–µ—Ç –≤ —Å–ø–∏—Å–∫–∏ –∑–Ω–∞—á–µ–Ω–∏—è –∏–∑ —Å—Ç–∞—Ä—ã—Ö –∑–∞–ø–∏—Å–µ–π
- –ù–∏–∫–æ–≥–¥–∞ –Ω–µ –≤–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—Ç—å: –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã–π –∏—Å—Ç–æ—á–Ω–∏–∫ ‚Äî —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫ (f.options –∏–∑ –ë–î)

## –ö–∞—Ä—Ç–∞ —Ç–µ—Ä—Ä–∏—Ç–æ—Ä–∏–∏ (—Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞, 2026-02-26)
- –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞: `#mapViewport` ‚Üí `#mapInner` (CSS transform) ‚Üí `<img>` + `<svg viewBox="0 0 100 100" preserveAspectRatio="none">` + `<div id="mapLabels">`
- Zoom: wheel 8%/step + –∫–Ω–æ–ø–∫–∏; pan: left-drag; state: `_mapZoom`, `_mapPanX/Y`
- SVG shapes: `<rect>` + `<polygon>`; –º–∞—Å—à—Ç–∞–±–Ω–æ-–∏–Ω–≤–∞—Ä–∏–∞–Ω—Ç–Ω—ã–µ (—Ä–∞–∑–º–µ—Ä—ã / `_mapZoom`)
- –õ–µ–π–±–ª—ã: HTML div, 13px, position:absolute; –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç: `short_name` ‚Üí `()` ‚Üí full name
- short_name: Migration 017, –ø–æ–ª–µ –≤ field_definitions –¥–ª—è building + land_plot
- –¶–≤–µ—Ç–∞ –∑–æ–Ω: —è—Ä–∫–∏–µ –ø—Ä–µsets, opacity ‚â• 0.65 –ø—Ä–∏ —Ä–µ–Ω–¥–µ—Ä–µ
- –§–∞–π–ª –∫–∞—Ä—Ç—ã: `server/public/maps/territory.jpg` (596KB), –æ—Ä–∏–≥–∏–Ω–∞–ª `Plan.jpg` (21MB)

## –ß—Ç–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ (2026-02-26 –ø–æ–∑–¥–Ω–∏–π –≤–µ—á–µ—Ä) ‚Äî 12 –∑–∞–¥–∞—á

### –ö–æ–º–º–∏—Ç—ã: 428a441, 502ea0e, 1a3af39, bdea6af, a23082c

1. **–ü–æ–∏—Å–∫ –ø–æ —Å—É–±–∞—Ä–µ–Ω–¥–∞—Ç–æ—Ä—É** ‚úÖ ‚Äî —Ä–∞—Å—à–∏—Ä–µ–Ω SQL: –∏—â–µ—Ç –≤ e.name + properties subtenant_name/contractor_name/our_legal_entity
2. **–ê–≤—Ç–æ–Ω–æ–º–µ—Ä –î–°** ‚úÖ ‚Äî –∑–∞–≥—Ä—É–∂–∞–µ—Ç —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –î–° –¥–ª—è –¥–æ–≥–æ–≤–æ—Ä–∞, –≤—ã—á–∏—Å–ª—è–µ—Ç max+1, –ø–æ–¥—Å—Ç–∞–≤–ª—è–µ—Ç
3. **–°–∫—Ä—ã—Ç—å parent_id –¥–ª—è –∫–æ–º–ø–∞–Ω–∏–π** ‚úÖ ‚Äî —É–∂–µ –±—ã–ª–æ —Å–¥–µ–ª–∞–Ω–æ —Ä–∞–Ω–µ–µ (land_plot + company excluded)
4. **–ü–ª–æ—â–∞–¥—å –ó–£: –≥–∞ ‚Üí –∫–≤.–º.** ‚úÖ ‚Äî Migration 018: –æ–±–Ω–æ–≤–ª—è–µ—Ç name_ru –ø–æ–ª—è area –¥–ª—è land_plot
5. **–°–æ–±—Å—Ç–≤–µ–Ω–Ω–∏–∫ –Ω–∞ –∫–∞—Ä—Ç–æ—á–∫–µ –ó–£** ‚úÖ ‚Äî –¥–æ–±–∞–≤–ª–µ–Ω balance_owner_id/name –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏; –∫–∞—Ä—Ç–æ—á–∫–∞ —É–∂–µ —á–∏—Ç–∞–µ—Ç balance_owner_name
6. **–°–ø–∏–Ω–Ω–µ—Ä –∑–∞–≥—Ä—É–∑–∫–∏** ‚úÖ ‚Äî CSS spinner-ring + showLoadingModal(); –¥–æ–±–∞–≤–ª–µ–Ω –≤ openCreateModal, openEditModal, openCreateSupplementModal, openContractCard, openSupplementCard
7. **–ü–æ–∏—Å–∫ –ø—Ä–∏ –≤—ã–±–æ—Ä–µ –∫–æ–Ω—Ç—Ä–∞–≥–µ–Ω—Ç–∞** ‚úÖ ‚Äî renderSearchableSelect: input + filtered dropdown + "–°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—É—é..." + mousedown/preventDefault
8. **–ù–î–° –≤ –î–°** ‚úÖ ‚Äî –¥–ª—è non-–ê—Ä–µ–Ω–¥–∞/–°—É–±–∞—Ä–µ–Ω–¥–∞: –æ—Ç–¥–µ–ª—å–Ω–æ–µ –ø–æ–ª–µ vat_rate; –¥–ª—è –ê—Ä–µ–Ω–¥–∞: —É–∂–µ –±—ã–ª–æ –≤ dynamic fields
9. **–°–æ–±—Å—Ç–≤–µ–Ω–Ω–∏–∫ —Ç–æ–ª—å–∫–æ –Ω–∞—à–∏ + –ø–æ–∏—Å–∫** ‚úÖ ‚Äî balance_owner uses _ownCompanies + renderSearchableSelect
10. **Quick-create –ó–£** ‚úÖ ‚Äî inline panel: –Ω–∞–∑–≤–∞–Ω–∏–µ, –∫–∞–¥–∞—Å—Ç—Ä–æ–≤—ã–π –Ω–æ–º–µ—Ä, –ø–ª–æ—â–∞–¥—å, –∞–¥—Ä–µ—Å, —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–∏–∫
11. **Inline-—Å–æ–∑–¥–∞–Ω–∏–µ –∫–æ–º–ø–∞–Ω–∏–∏** ‚úÖ ‚Äî —É–∂–µ –±—ã–ª–æ —á–µ—Ä–µ–∑ "–î—Ä—É–≥–æ–µ..." + onEntityCustomConfirm
12. **–ó–∞—â–∏—Ç–∞ –æ—Ç –¥—É–±–ª–µ–π –∫–æ–º–ø–∞–Ω–∏–π** ‚úÖ ‚Äî fuzzy check (toLowerCase + strip punctuation + indexOf) + confirm dialog

### Searchable Select –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞
- `renderSearchableSelect(id, entities, selectedId, selectedName, placeholder, fieldName)` ‚Üí hidden input + text input + dropdown
- `_srchInitAll()` ‚Äî –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è –ø–æ—Å–ª–µ –∫–∞–∂–¥–æ–≥–æ setModalContent; binds focus/input/keydown/mousedown
- `_srchGetList(id)` ‚Äî –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç _ownCompanies –¥–ª—è our_legal_entity/balance_owner, _allCompanies –¥–ª—è –æ—Å—Ç–∞–ª—å–Ω—ã—Ö
- `_srchFilter(id)` ‚Äî —Ñ–∏–ª—å—Ç—Ä—É–µ—Ç —Å–ø–∏—Å–æ–∫, —Ä–µ–Ω–¥–µ—Ä–∏—Ç items —Å data-srch-pick; mousedown+preventDefault –¥–ª—è click-before-blur
- `_srchPick(id, entityId)` ‚Äî —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç hidden value + text display
- `_srchPickNew(id)` ‚Äî –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç custom input –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –Ω–æ–≤–æ–π
- `collectEntityIds` —á–∏—Ç–∞–µ—Ç hidden input `f_contractor_name` (value = entity ID) ‚Äî —Ä–∞–±–æ—Ç–∞–µ—Ç –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π

## ‚úÖ –ó–∞–¥–∞—á–∏ 1‚Äì12 ‚Äî –≤—Å–µ –∑–∞–≤–µ—Ä—à–µ–Ω—ã (2026-02-26)
1. –ü–æ–∏—Å–∫ –ø–æ —Å—É–±–∞—Ä–µ–Ω–¥–∞—Ç–æ—Ä—É ‚Äî `428a441`
2. –ê–≤—Ç–æ–Ω–æ–º–µ—Ä –î–° ‚Äî `502ea0e`
3. parent_id —Å–∫—Ä—ã—Ç –¥–ª—è –∫–æ–º–ø–∞–Ω–∏–π ‚Äî (—É–∂–µ –±—ã–ª–æ)
4. –ü–ª–æ—â–∞–¥—å –ó–£ –∫–≤.–º. ‚Äî `428a441`
5. –°–æ–±—Å—Ç–≤–µ–Ω–Ω–∏–∫ –Ω–∞ CREATE ‚Äî `428a441`
6. –°–ø–∏–Ω–Ω–µ—Ä –∑–∞–≥—Ä—É–∑–∫–∏ ‚Äî `1a3af39`
7. Searchable dropdown –∫–æ–Ω—Ç—Ä–∞–≥–µ–Ω—Ç ‚Äî `bdea6af`
8. –ù–î–° –≤ –î–° ‚Äî `502ea0e`
9. Searchable dropdown —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–∏–∫ ‚Äî `bdea6af`
10. Quick-create –ó–£ inline ‚Äî `a23082c`
11. Inline —Å–æ–∑–¥–∞–Ω–∏–µ –∫–æ–º–ø–∞–Ω–∏–∏ ‚Äî (—É–∂–µ –±—ã–ª–æ)
12. Fuzzy –∑–∞—â–∏—Ç–∞ –æ—Ç –¥—É–±–ª–µ–π ‚Äî `a23082c`

## –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ (2026-02-26 —Ñ–∏–Ω–∞–ª)
- **Mobile sidebar toggle** (`419beb1`): hamburger + overlay –Ω–∞ < 768px
- **BI Views** (`1b3959b`): `v_bi_contracts`, `v_bi_supplements`, `v_bi_rent_objects`, `v_bi_equipment`, `v_bi_buildings`, `v_bi_acts` ‚Äî PostgreSQL views –¥–ª—è Metabase; Migration 020 –≤ startup chain

## –ß—Ç–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ (2026-02-26 –ø–æ–∑–¥–Ω–æ) ‚Äî Contract card + Emergency highlighting
- **Emergency/Broken highlighting –≤–µ–∑–¥–µ**: `loadBrokenEquipment()` await –≤ buildAggregateReport, runLinkedReport, showEntityList('equipment'); –±–µ–π–¥–∂–∏ –Ω–∞ –ª–∏—Å—Ç–æ–≤—ã—Ö + eq_name —É–∑–ª–∞—Ö
- **Duplicate eq level fix**: `eqAlreadyGrouped` ‚Äî –ø—Ä–æ–ø—É—Å–∫–∞–µ—Ç eqGroups –∫–æ–≥–¥–∞ eq_name —É–∂–µ –≤ –∏–µ—Ä–∞—Ä—Ö–∏–∏
- **Contract card view**: `GET /api/reports/contract-card/:id` ‚Üí renderContractCard(); collapsible —Å–µ–∫—Ü–∏–∏; total_monthly; equipment_list —Å is_broken —Ñ–ª–∞–≥–æ–º
- **Contract card –∫–∞–∫ default**: `showEntity(id, _forceDetail)` –¥–ª—è –∞—Ä–µ–Ω–¥—ã‚Üícard; `showEntityDetail(id)` wrapper; –∫–Ω–æ–ø–∫–∞ "‚öô –î–µ—Ç–∞–ª–∏" –¥–ª—è raw view
- **ER diagram**: `/root/workspace-indparkdocs/er-diagram.html`; —Å–∫—Ä–∏–Ω—à–æ—Ç –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω –í–∞–ª–µ–Ω—Ç–∏–Ω–µ

## üöß –í –æ—á–µ—Ä–µ–¥–∏ (–Ω–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ)
- **üêõ –ö—Ä–∞–Ω—ã: –Ω–µ—Å—Ç–∏–Ω–≥ –≤ –¥–µ—Ä–µ–≤–µ** ‚Äî –≤—Å–µ –∫—Ä–∞–Ω—ã (id:30-41, `parent_id=29`) –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è –≤–ª–æ–∂–µ–Ω–Ω—ã–º–∏ –ø–æ–¥ –ø–µ—Ä–≤—ã–π –∫—Ä–∞–Ω –≤ –∫–∞–∫–æ–º-—Ç–æ tree-widget –≤–æ frontend; –¥–∞–Ω–Ω—ã–µ –≤ –ë–î –í–ï–†–ù–´–ï; –±–∞–≥ –≤ frontend tree-rendering; –Ω—É–∂–Ω–æ –Ω–∞–π—Ç–∏ –∏ –∏—Å–ø—Ä–∞–≤–∏—Ç—å
- **Room form cleanup** ‚Äî Migration 015: —É–¥–∞–ª–∏—Ç—å `room_type` –∏–∑ field_definitions + –¥–æ–±–∞–≤–∏—Ç—å `room_number` (text, sort_order=4) —Å ON CONFLICT DO NOTHING
- **–ö–∞—Ä—Ç–∞: –ø–æ–ª–∏–≥–æ–Ω—ã (–ü–†–ï–†–í–ê–ù–û)** ‚Äî SVG overlay; drag rect, click+dblclick polygon; —Å–µ–∫—Ü–∏—è ~2247‚Äì2515 –≤ frontend.js
- **BI/Metabase** ‚Äî –ø–æ–¥–∫–ª—é—á–∏—Ç—å –∫–æ–≥–¥–∞ –±–∞–∑–∞ –Ω–∞–ø–æ–ª–Ω–∏—Ç—Å—è –¥–∞–Ω–Ω—ã–º–∏ (views —É–∂–µ –≥–æ—Ç–æ–≤—ã)
- **üìä –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –≤–ª–∞–¥–µ–Ω–∏—è** *(ER ‚Üí —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏–µ)*
- **üë§ –†–∞–∑–Ω—ã–µ –∫–æ–Ω—Ç–∞–∫—Ç—ã** *(ER ‚Üí —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏–µ)*
- **üìã –ü—Ä–µ–¥–º–µ—Ç—ã –¥–æ–≥–æ–≤–æ—Ä–∞ —É—Å–ª—É–≥** *(ER ‚Üí —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏–µ)* ‚Äî –ø—Ä–µ–¥–º–µ—Ç + –æ–±—ä–µ–∫—Ç (–æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ/–∫–æ—Ä–ø—É—Å/–ó–£) + —Ü–µ–Ω–∞ + —Å—Ä–æ–∫ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è
- **üõí –î–æ–≥–æ–≤–æ—Ä –∫—É–ø–ª–∏-–ø—Ä–æ–¥–∞–∂–∏ ‚Äî –ø—Ä–µ–¥–º–µ—Ç –∏ —Å–≤—è–∑–∏** *(ER ‚Üí —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏–µ)*
- **üè¢ –ù–µ—Å–∫–æ–ª—å–∫–æ –∫–æ—Ä–ø—É—Å–æ–≤ –≤ –¥–æ–≥–æ–≤–æ—Ä–µ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏—è** *(backlog, 2026-02-26)* ‚Äî —Å–µ–π—á–∞—Å —Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω –∫–æ—Ä–ø—É—Å; –Ω—É–∂–µ–Ω multi-select / –ø–æ–≤—Ç–æ—Ä—è–µ–º—ã–µ –±–ª–æ–∫–∏ –∫–æ—Ä–ø—É—Å+–æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ
- **‚öôÔ∏è –î–∞–Ω–Ω—ã–µ: —Ä–∞–∑–Ω–µ—Å—Ç–∏ –ò–ö –æ–±–æ–≥—Ä–µ–≤–∞—Ç–µ–ª–∏ 10–∫ –ø–æ –±–ª–æ–∫–∞–º** *(backlog, 2026-02-26)* ‚Äî —Å–µ–π—á–∞—Å –æ–¥–Ω–∞ –∑–∞–ø–∏—Å—å "–ò–ö –æ–±–æ–≥—Ä–µ–≤–∞—Ç–µ–ª–∏ 10–∫"; –Ω—É–∂–Ω–æ —Ä–∞–∑–±–∏—Ç—å –ø–æ –±–ª–æ–∫–∞–º + –æ–±–Ω–æ–≤–∏—Ç—å –¥–æ–≥–æ–≤–æ—Ä –ê–¥–º–æ—Å –Ω–∞ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ —Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º
- **üîç –ü–æ–ª–Ω–æ—Ç–µ–∫—Å—Ç–æ–≤—ã–π –ø–æ–∏—Å–∫ –ø–æ –≤—Å–µ–º –ø–æ–ª—è–º** *(backlog, 2026-02-26)* ‚Äî —Å–µ–π—á–∞—Å –∏—â–µ—Ç —Ç–æ–ª—å–∫–æ –ø–æ name + –æ—Ç–¥–µ–ª—å–Ω—ã–º properties; –Ω—É–∂–Ω–æ –∏—Å–∫–∞—Ç—å –ø–æ –≤—Å–µ–º –ø–æ–ª—è–º (–ø—Ä–∏–º–µ—Ä: "–ò–ö" –Ω–∞—Ö–æ–¥–∏—Ç –¥–æ–≥–æ–≤–æ—Ä —Å –ø—Ä–µ–¥–º–µ—Ç–æ–º "–ò–ö –æ–±–æ–≥—Ä–µ–≤–∞—Ç–µ–ª–∏"); —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å —á–µ—Ä–µ–∑ `properties::text ILIKE $1` –∏–ª–∏ –æ—Ç–¥–µ–ª—å–Ω—ã–π –∏–Ω–¥–µ–∫—Å GIN

## –ü—Ä–∞–≤–∏–ª–∞ workflow
- **–í—Å–µ–≥–¥–∞ –ø–ª–∞–Ω ‚Üí –û–ö –í–∞–ª–µ–Ω—Ç–∏–Ω—ã ‚Üí –∫–æ–¥**. –ù–∏–∫–∞–∫–∏—Ö —Å–∞–º–æ–≤–æ–ª—å–Ω—ã—Ö –ø—Ä–∞–≤–æ–∫!
- **–ù–ò–ö–û–ì–î–ê –Ω–µ –¥–æ–±–∞–≤–ª—è—Ç—å/–∏–∑–º–µ–Ω—è—Ç—å –Ω–∏—á–µ–≥–æ –∏–∑ —Å—Ö–µ–º—ã –±–µ–∑ —è–≤–Ω–æ–≥–æ —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏—è!**
  –≠—Ç–æ –∫–∞—Å–∞–µ—Ç—Å—è: entity types, –ø–æ–ª—è —Å—É—â–Ω–æ—Å—Ç–µ–π, relation types, —Å–≤—è–∑–∏, —Å–ø–∏—Å–∫–∏ (—Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–∏) ‚Äî –∏ –≤–æ–æ–±—â–µ –≤—Å—ë, —á—Ç–æ –∑–∞–∫—Ä–µ–ø–ª–µ–Ω–æ –≤ —Å—Ö–µ–º–µ.
  –ê–ª–≥–æ—Ä–∏—Ç–º: —Å–æ–æ–±—â–∏—Ç—å —á—Ç–æ –∏–º–µ–Ω–Ω–æ –Ω—É–∂–Ω–æ –∏–∑–º–µ–Ω–∏—Ç—å ‚Üí –ø—Ä–∏—Å–ª–∞—Ç—å **–æ–±–Ω–æ–≤–ª—ë–Ω–Ω—É—é —Å—Ö–µ–º—É** ‚Üí –¥–æ–∂–¥–∞—Ç—å—Å—è –û–ö –æ—Ç –í–∞–ª–µ–Ω—Ç–∏–Ω—ã ‚Üí —Ç–æ–ª—å–∫–æ –ø–æ—Ç–æ–º –∫–æ–¥.
- `\'` –≤–Ω—É—Ç—Ä–∏ template literal ‚Üí `'` (—Å–ª–µ—à —Å—ä–µ–¥–∞–µ—Ç—Å—è). –í—Å–µ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å data-–∞—Ç—Ä–∏–±—É—Ç—ã –∏–ª–∏ `\\'`
- –ü–µ—Ä–µ–¥ –ø—É—à–µ–º –ø—Ä–æ–≤–µ—Ä—è—Ç—å JS —Å–∫—Ä–∏–ø—Ç—ã:
```bash
cd /root/workspace-indparkdocs/server && node -e "const html = require('./src/frontend.js'); const scripts = html.match(/<script>([\s\S]*?)<\/script>/g) || []; let ok=true; scripts.forEach((s,i)=>{const body=s.replace(/<\/?script>/g,''); try{new Function(body);}catch(e){console.error('Script block '+i+' ERROR:',e.message);ok=false;}}); if(ok) console.log('All scripts OK');"
```

## –ü–ª–∞–Ω—ã / Next Steps
- –î–æ–ø–∏—Å–∞—Ç—å JS —Ñ—É–Ω–∫—Ü–∏–∏ –¥–ª—è "–ê–Ω–∞–ª–∏–∑ –∞—Ä–µ–Ω–¥—ã"
- –ü—Ä–æ—Ä–∞–±–æ—Ç–∞—Ç—å –Ω–æ–≤—ã–π UX –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∏ —Å—Ç—Ä–æ–∫ –≤ agg report
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–∞—Ä—Ç–æ—á–∫—É –¥–æ–≥–æ–≤–æ—Ä–∞ –∞—Ä–µ–Ω–¥—ã –Ω–∞ –∂–∏–≤–æ–º —Å–∞–π—Ç–µ
